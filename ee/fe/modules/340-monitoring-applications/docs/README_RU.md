---
title: "Модуль monitoring-applications"
---

## Описание

Модуль собирает из кластера информацию о работающих приложениях и настраивает для них:
* набор Dashboard для Grafana (взяты из интернета, не выверены и не проверены),
* PrometheusRules для Prometheus,
* ServiceMonitor для Prometheus.

Активировать приложения можно явно в [конфигурации](configuration.html).

## Доступность dashboard в Grafana

Дашборды отображаются только для приложений, которые либо были обнаружены при автоматическом исследовании по лейблу сервиса
`prometheus.deckhouse.io/target`, либо явно указаны в параметре `enabledApplications`.

## Как собирать метрики с приложения?

> Указанный ниже способ сбора метрик, предназначен для случаев, когда приложение находится в [списке поддерживаемых](configuration.html#параметры). Если приложение, с которого необходимо собирать метрики, **не находится** в [списке поддерживаемых](configuration.html#параметры), то необходимо воспользоваться [другим способом](../prometheus/faq.html#как-собирать-метрики-с-приложений-в-вашем-проекте) сбора метрик, который реализуется с помощью модуля [monitoring-custom](../monitoring-custom/).

1. Необходимо поставить лейбл `prometheus.deckhouse.io/target` на Service, который вы хотите мониторить. В значении лейбла необходимо указать имя application из [списка](configuration.html#параметры).
2. Указать порту, с которого необходимо собирать метрики, имя `http-metrics` и `https-metrics` для подключения по HTTP или HTTPS соответственно.
Если это не возможно, предлагается воспользоваться двумя аннотациями: `prometheus.deckhouse.io/port: номер_порта` для указания порта и `prometheus.deckhouse.io/tls: "true"`, если сбор метрик будет проходить по HTTPS.
3. Указать дополнительные аннотации для более тонкой настройки:
    * `prometheus.deckhouse.io/path` — путь для сбора метрик (по умолчанию: `/metrics`)
    * `prometheus.deckhouse.io/query-param-$name` — аргумент $name=$value для GET query (по умолчанию: ``)
    * `prometheus.deckhouse.io/allow-unready-pod` — разрешает сбор метрик с Pod'ов в любом состоянии (по умолчанию метрики собираются только с подов в состоянии Ready).
    * `prometheus.deckhouse.io/sample-limit` — сколько семплов разрешено собирать с Pod'а (значение лимита по умолчанию можно посмотреть в таблице выше).

Подробнее о том, как мониторить приложения, можно ознакомиться [здесь](../prometheus/faq.html).
