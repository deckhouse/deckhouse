---
title: "Модуль service-with-healthchecks"
---

В kubernetes трафик направляется только на "живые" поды (с помощью Service и EndpointSlices), при этом "живость" определяется всего одной на весь под проверкой - readiness-пробой пода.

Существуют варианты, когда поды содержат несколько процессов (как ВМ) и каждый из них может обрабатывать трафик независимо. В данном случае одной readiness-пробы недостаточно.

Данный модуль реализует возможность независимо проверять доступность каждого процесса и по результатам нового набора проб направлять на них трафик.

Настроить новый способ балансировки можно при помощи ресурса ServiceWithHealthchecks:
- его спецификация идентична Service с добавлением раздела healthchecks, который содержит набор новых проверок.
- при создании данного ресурса создаются дочерние Service (без selector) и соответствующие EndpointSlices.
- непосредственно проверку доступности целевых процессов выполняют агенты, развернутые на каждой ноде.
