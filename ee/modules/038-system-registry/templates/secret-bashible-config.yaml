---
apiVersion: v1
kind: Secret
metadata:
  name: registry-bashible-config
  namespace: d8-system
  {{- include "helm_lib_module_labels" (list . (dict "app" "registry" "name" "registry-bashible-config")) | nindent 2 }}
data:
{{- with .Values.systemRegistry.internal.state }}
  version: {{ .bashible_version | b64enc }}
{{- else }}
  version: {{ "unknown" | b64enc }}
{{- end }}

{{- with .Values.systemRegistry.internal.bashible }}
  proxyEndpoints: {{ .proxyEndpoints | toYaml | default "[]" | b64enc }}
  hosts: {{ .hosts | toYaml | default "[]" | b64enc }}
  prepullHosts: {{ .prepullHosts | toYaml | default "[]" | b64enc }}
{{- else }}
  proxyEndpoints: {{ "[]" | b64enc }}
  hosts: {{ "[]" | b64enc }}
  prepullHosts: {{ "[]" | b64enc }}
{{- end }}
