{{- with .Values.systemRegistry.internal.module.users -}}
{{- if .enabled -}}
{{- with .state -}}

{{- $version := .version -}}
{{- $name, $user := range .data -}}

---
apiVersion: v1
kind: Secret
metadata:
  {{- include "helm_lib_module_labels" (list $ (dict "app" "registry" "type" "registry-user", "version", $version )) | nindent 2 }}
  name: {{ $name }}
  namespace: d8-system
type: registry/user
data:
  name: {{ $user.name | b64enc }}
  password: {{ $user.password | b64enc }}
  passwordHash: {{ $user.passwordHash | b64enc }}

{{- end }}
{{- end }}
{{- end }}
{{- end }}
