{{- with (.Values.systemRegistry.internal.orchestrator).state -}}
{{- $version := .version -}}
{{- with (.data).pki -}}

---
apiVersion: v1
kind: Secret
metadata:
  name: registry-pki
  namespace: d8-system
  {{- include "helm_lib_module_labels" (list $ (dict "app" "registry" "type" "registry-pki" )) | nindent 2 }}
  annotations:
    registry.deckhouse.io/config-version: {{ $version }}
type: registry/pki
data:
  ca.crt: {{ .ca.cert | b64enc }}
  ca.key: {{ .ca.key | b64enc }}
  token.crt: {{ .token.cert | b64enc }}
  token.key: {{ .token.key | b64enc}}

{{- end }}
{{- end }}
