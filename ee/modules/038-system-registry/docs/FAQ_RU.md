---
title: "Модуль registry: FAQ"
description: ""
---

## Как посмотреть статус переключения режима registry?

Статус переключения режима registry можно получить с помощью команды:

```bash
kubectl -n d8-system -o yaml get secret registry-state | yq -C -P '.data | del .state | map_values(@base64d) | .conditions = (.conditions | from_yaml)'"
```
<!-- TODO(nabokihms): заменить на подкоманду d8, когда она будет реализована -->


### Что означают условия в `registry-state`?

Каждое условие может быть в состоянии `True` или `False`, а так же иметь поле `message`, в котором содержится описание состояния. Ниже приведены все типа условий, которые могут быть в `registry-state` и их описание:


| Условие                           | Описание                                                                                                                                                                                                 |
|-----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `ContainerdConfigPreflightReady`  | Состояние проверки конфигурации `containerd` перед переключением режима. Проверяется, что на узле используется именно `containerd` и что его конфигурация не содержит ручных пользовательских изменений. |
| `TransitionContainerdConfigReady` | Состояние подготовки конфигурации `containerd` в новый режим. Проверяется, что конфигурация `containerd` успешно подготовлена для нового режима.                                                         |
| `FinalContainerdConfigReady`      | Состояние завершения переключения режима. Проверяется, что все изменения в конфигурации `containerd` успешно применены и система готова к работе в новом режиме.                                         |
| `DeckhouseRegistrySwitchReady`    | Переключение на новый адрес container registry. Проверяется, что новый адрес успешно применен и компоненты Deckhouse готовы к работе с новым registry.                                                   |
| `InClusterProxyReady`             | Состояние готовности In-Cluster Proxy. Проверяется, что In-Cluster Proxy успешно запущен и работает.                                                                                                     |
| `CleanupInClusterProxy`           | Состояние очистки In-Cluster Proxy, если прокси не нужен для работы желаемого режима. Проверяется, что все ресурсы, связанные с In-Cluster Proxy, успешно удалены.                                       |
| `NodeServicesReady`               | Состояние готовности сервисов на узлах. Проверяется, что все необходимые сервисы на узлах успешно запущены и работают.                                                                                   |
| `CleanupNodeServices`             | Состояние очистки сервисов на узлах, если сервисы не нужны для работы желаемого режима. Проверяется, что все ресурсы, связанные с сервисами на узлах, успешно удалены.                                   |
| `Ready`                           | Общее состояние готовности registry к работе в указанном режиме. Проверяется, что все предыдущие условия выполнены и модуль готов к работе.                                                              |


<!--
Ниже приведены вопросы и ответы по эксплуатации запущенного модуля `embedded-registry`

## Как переключить режим с Mirror на Proxy?

- **TODO**:

## Как переключить режим с Proxy на Mirror?

- **TODO**:

{% alert level="warning" %}
**Обратите внимание!** На данный момент работает через последовательное [выключение](./examples.html#%D0%B2%D1%8B%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F) и [включение модуля](./examples.html#%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA-mirror-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B0-%D0%BD%D0%B0-%D0%B7%D0%B0%D0%BF%D1%83%D1%89%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B5)
{% endalert %}

## Как переключиться upstream на новый registry в режиме Proxy?

- **TODO**:
-->
