---
title: "Сloud provider — OpenStack: настройки"
--- 

**Примечание:** В зависимости от того, как организован кластер сети, выбирается соответствующий layout.

<--- добавить схему лэйаута --->

Модуль автоматически активируется для всех облачных кластеров, созданных в OpenStack.

Количество и характеристики процесса заказа облачных машин настраиваются в пользовательском ресурсе [`NodeGroup`](../../modules/040-node-manager/cr.html#nodegroup) модуля `node-manager`, где также указывается имя группы узлов инстанс-класса (`cloudInstances.classReference` в NodeGroup).

Для OpenStack инстанс-класс представляет собой пользовательский ресурс `OpenStackInstanceClass`, в котором определяются конкретные параметры машин.

Настройки модуля автоматически устанавливаются на основе выбранной схемы размещения. Обычно ручная конфигурация модуля не требуется.

Гибридный кластер представляет собой объединенные в один кластер bare-metal-узлы и узлы vSphere. Для создания такого кластера необходимо наличие L2-сети между всеми узлами кластера. Для конфигурации bare-metal кластера с дополнительными инстансами OpenStack выполните следующие шаги:

1. Удалите flannel из kube-system: kubectl -n kube-system delete ds flannel-ds.

2. Включите модуль и пропишите необходимые параметры.

> **Важно!** `Cloud-controller-manager` синхронизирует состояние между vSphere и Kubernetes, удаляя из Kubernetes те узлы, которых нет в vSphere. В гибридном кластере такое поведение не всегда необходимо. Если узел Kubernetes запущен не с параметром `--cloud-provider=external`, он автоматически игнорируется (Deckhouse прописывает static:// на узлы в `.spec.providerID`, а `cloud-controller-manager` такие узлы игнорирует).

> **Внимание!** При изменении настроек модуля не происходит **пересоздания существующих объектов `Machines` в кластере** (новые объекты `Machine` будут создаваться с новыми параметрами). Пересоздание происходит только при изменении параметров `NodeGroup` и `OpenStackInstanceClass`. См. подробнее [в документации модуля node-manager](../../modules/040-node-manager/faq.html#как-пересоздать-эфемерные-машины-в-облаке-с-новой-конфигурацией).
Для настройки аутентификации с помощью модуля `user-authn` необходимо в Crowd'е проекта создать новое `Generic` приложение.

{% include module-settings.liquid %}
