spec:
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              requiredEngineVersion:
                description: |
                  Используется для определения совместимости с версией Falco.
              requiredK8sAuditPluginVersion:
                description: |
                  Используется для определения совместимости с версией плагина аудита Kubernetes.
              rules:
                description: |
                  Описывает правила Falco, которые будут применяться во время мониторинга кластера.

                  Эти правила помогают обнаружить угрозы во время работы кластера, анализируя особенности поведения приложений и контейнеров.

                  Подробности см. [в документации Falco](https://falco.org/docs/rules/) и [справочнике](https://falco.org/docs/reference/rules/).
                items:
                  properties:
                    rule:
                      description: |
                        Правило, по которому будет создаваться событие.

                        Сопровождается подробным описанием того, что произошло.
                      properties:
                        name:
                          description: |
                            Короткое уникальное имя для правила.
                        condition:
                          description: |
                            Фильтрующее выражение; применяется к событиям для проверки соответствия правилу.
                        desc:
                          description: |
                            Подробное описание того, что должно обнаружить правило.
                        output:
                          description: |
                            Сообщение, которое будет отправляться при наступлении события.
                        priority:
                          description: |
                            Уровень опасности события.
                        enabled:
                          description: |
                            Если значение — `false`, правило не будет ни загружено, ни применено к событиям.
                        tags:
                          description: |
                            Список меток, применяемых к правилу.
                        source:
                          description: |
                            Источник данных, для которого применяется правило.
                    macro:
                      description: |
                        Правило, которое может переиспользоваться в других правилах или макросах.

                        Макрос позволяет заменить сложные повторяющиеся выражения на имя макроса.
                      properties:
                        name:
                          description: |
                            Короткое уникальное имя для макроса.
                        condition:
                          description: |
                            Фильтрующее выражение; применяется к событиям для проверки соответствия правилу.
                    list:
                      description: |
                        Список значений, которые могут использоваться в макросах, правилах и других списках.

                        В отличие от макросов и правил, у списков нет условий (condition).
                      properties:
                        name:
                          description: |
                            Уникальное имя списка.
                        items:
                          description: |
                            Список значений.
