{!{ define "cve_tests" }!}
# <template: cve_tests>
{!{- $ctx       := index . 0 }!}
{!{- $args_name := index . 1 }!}
{!{- $args := printf "cve-%s" $args_name }!}
runs-on: [self-hosted, regular]
steps:
{!{ tmpl.Exec "started_at_output"       $ctx | strings.Indent 2 }!}
{!{ tmpl.Exec "checkout_full_step"      $ctx | strings.Indent 2 }!}
{!{ tmpl.Exec "login_dev_registry_step" $ctx | strings.Indent 2 }!}
{!{ tmpl.Exec "login_rw_registry_step"  $ctx | strings.Indent 2 }!}
  - name: Run CVE tests
    run: |
      echo "⚓️ 🏎 Running CVE tests on $GITHUB_REF_NAME...'
      make {!{ $args }!}
# </template: cve_tests>
{!{- end -}!}
