# Use default Gitleaks rules
[extend]
useDefault = true

# Global allowlists
[allowlist]

# === Safe files/directories ===
# NOTE: Use exact paths, NOT glob patterns like **/go.mod

paths = [
    # Go dependencies - public hashes
    "go.mod",
    "go.sum",
    
    # Specific files with known false positives
    # "modules/101-cert-manager/docs/USAGE.md",
    # "modules/101-cert-manager/docs/USAGE_RU.md",
]

# === Safe patterns ===
regexes = [
    # Go module checksums - always public
    '''h1:[A-Za-z0-9+/=]{40,}''',
    
    # Public certificates (only ca.crt, NOT private keys!)
    '''data:\s*\n\s*ca\.crt:\s*[A-Za-z0-9+/=\s]+''',
    
    # AWS Example values from official documentation - exact match
    '''AKIAIOSFODNN7EXAMPLE''',
    '''wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY''',
]

# Custom rules for hashi/openbao/werf tokens
[[rules]]
id = "werf-secret-key"
description = "Identified a Werf Secret Key."
regex = '''\b([a-f0-9]{32})\b'''
path = '''\.werf_secret_key$'''

[[rules]]
id = "hashicorp-vault-token"
description = "Identified a HashiCorp Vault token (hvs, hvb, or hvr prefix)."
regex = '''\b(hv[sbr]\.[A-Za-z0-9_-]{20,})\b'''

[[rules]]
id = "openbao-token"
description = "Identified an OpenBao token (S. prefix)."
regex = '''\b(S\.[A-Za-z0-9_-]{20,})\b'''