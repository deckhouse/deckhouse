{{- $_ := set . "OssYamlPath" "oss.yaml" -}}
project: test-oss-yaml-helper
configVersion: 1
---
image: test
from: alpine:3.20
shell:
  install:
  - echo ok

{{- $raw := printf "data:\n%s" (include "get_oss_version_strings_by_id" (list "example-service" $)) | fromYaml -}}
{{- $versions := index $raw "data" -}}

{{- if ne (len $versions) 2 -}}
  {{- fail (printf "expected 2 versions, got %d" (len $versions)) -}}
{{- end -}}
{{- if ne (index $versions 0) "1.2.1" -}}
  {{- fail (printf "expected first version=1.2.1, got %v" (index $versions 0)) -}}
{{- end -}}
{{- if ne (index $versions 1) "1.2.2" -}}
  {{- fail (printf "expected second version=1.2.2, got %v" (index $versions 1)) -}}
{{- end -}}
