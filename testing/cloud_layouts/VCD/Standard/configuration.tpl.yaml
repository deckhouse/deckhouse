apiVersion: deckhouse.io/v1
kind: ClusterConfiguration
clusterType: Cloud
cloud:
  provider: VCD
  prefix: '${PREFIX}'
podSubnetCIDR: 10.111.0.0/16
serviceSubnetCIDR: 10.222.0.0/16
kubernetesVersion: '${KUBERNETES_VERSION}'
defaultCRI: '${CRI}'
clusterDomain: "cluster.local"
---
apiVersion: deckhouse.io/v1
kind: InitConfiguration
deckhouse:
  imagesRepo: dev-registry.deckhouse.io/sys/deckhouse-oss
  registryDockerCfg: '${DECKHOUSE_DOCKERCFG}'
  devBranch: '${DEV_BRANCH}'
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: global
spec:
  enabled: true
  settings:
    modules:
      publicDomainTemplate: "%s.k8s.smoke.flant.com"
      placement:
        customTolerationKeys:
          - node
  version: 1

---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: cni-cilium
spec:
  enabled: true

---
apiVersion: deckhouse.io/v1
kind: VCDClusterConfiguration
layout: Standard
internalNetworkCIDR: 192.168.254.0/23 # 192.168.254.0/24 - dhctp, 192.168.255.0/24 - metalb
masterNodeGroup:
  instanceClass:
    storageProfile: Fast vHDD
    sizingPolicy: ${VCD_ORG}-MSK
    etcdDiskSizeGb: 10
    rootDiskSizeGb: 50
    template: private-templates/Ubuntu 24.04 Server (20240628)
  replicas: ${MASTERS_COUNT}
provider:
  password: ${VCD_PASSWORD}
  server: ${VCD_SERVER}
  username: ${VCD_USERNAME}
  insecure: true
organization: ${VCD_ORG}
virtualApplicationName: deckhouse-e2e
virtualDataCenter: ${VCD_ORG}-MSK1-S1-vDC2
mainNetwork:  deckhouse-e2e
sshPublicKey: "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHv4oItTf1HuXU5T7Ly8/8Fpaxzf0cuAmLElP9R+R+A0 root@9c60180db21d"
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: deckhouse
spec:
  version: 1
  enabled: true
  settings:
    highAvailability: false
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: flant-integration
spec:
  enabled: false
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: istio
spec:
  version: 2
  enabled: true
  settings:
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: openvpn
spec:
  version: 2
  enabled: true
  settings:
