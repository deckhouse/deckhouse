{% assign topnav = site.data[page.topnav].topnav[page.lang] %}

<div class="header-container">
  <header class="header {%- if page.lang == 'ru' %} header_float{%- endif %}">
    <div class="header__content container">
      <div class="header__left-box">
        <ul id="top-header-nav" class="nav header__nav">
          <li class="header__navigation-item current-menu-parent menu-item-has-children">
          {%- unless site.mode == "module" %}
            {%- if page.lang == "ru" %}
            <a href="#">Продукты</a>
            <div class="sub-menu-container">
            <ul class="sub-menu sub-menu_products">
              <li>
                <a href="/products/kubernetes-platform/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#kubernetes-platform-icon"></use>
                  </svg>
                  <span>Kubernetes Platform</span>
                  <p>Создание идентичных Kubernetes-кластеров и&nbsp;управление ими</p>
                </a>
              </li>
              <li>
                <a href="/products/virtualization-platform/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#virtualization-platform-icon"></use>
                  </svg>
                  <span>Virtualization Platform</span>
                  <p>Управление виртуальными машинами</p>
                </a>
              </li>
              <li>
                <a href="/products/observability-platform/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#observability-platform-icon"></use>
                  </svg>
                  <span>Observability Platform</span>
                  <p>Мониторинг и&nbsp;журналирование инфраструктуры и&nbsp;приложений</p>
                </a>
              </li>
              <li>
                <a href="/products/stronghold/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#stronghold-icon"></use>
                  </svg>
                  <span>Stronghold</span>
                  <p>Безопасное управление жизненным циклом секретов</p>
                </a>
              </li>
              <li>
                <a href="/products/delivery-kit/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#delivery-icon"></use>
                  </svg>
                  <span>Delivery Kit</span>
                  <p>Сборка и&nbsp;доставка контейнеризованного&nbsp;ПО</p>
                </a>
              </li>
              <li>
                <a href="/products/commander/">
                  <svg class="products__icon">
                    <use xlink:href="/images/sprite.svg#commander-icon"></use>
                  </svg>
                  <span>Commander</span>
                  <p>Центр управления парком кластеров</p>
                </a>
              </li>
              <li>
                <a href="/products/prompp/">
                  <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path id="Rectangle 75" d="M0.749023 13.9888H16.2508L15.7448 15.8522H1.25505L0.749023 13.9888Z" fill="#00003C"/>
                    <path id="Vector" d="M12.2239 17.8746V16.9834L4.79004 16.9834V17.8746L8.50699 20L12.2239 17.8746Z" fill="#00003C"/>
                    <path id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M15.1528 3.81515V12.8575H8.50695H1.86108V3.81515L8.50695 0L15.1528 3.81515ZM6.59876 9.84508H8.84374C10.0801 9.84508 11.0887 8.83209 11.0887 7.59038C11.0887 6.34866 10.0801 5.33568 8.84374 5.33568H6.59876V9.84508Z" fill="#0064FF"/>
                  </svg>
                  <span>Prom++</span>
                  <p>Open Source-система мониторинга</p>
                </a>
              </li>
              <li>
                <a href="/products/code/">
                  <svg width="20" height="20" viewBox="0 0 280 280" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M208.947 41.7573L250.705 0H0V250.757L41.8106 208.757L41.927 41.9269L208.947 41.7573Z" fill="#00003C"/>
                    <path d="M280 29.5309L238.447 71.2573L238.073 238.073L71.4473 238.088L29.5386 280H280V29.5309Z" fill="#00003C"/>
                    <path d="M145.855 179.993H105.855V99.9932H145.855C167.884 99.9932 185.855 117.964 185.855 139.993C185.855 162.022 167.884 179.993 145.855 179.993Z" fill="#0064FF"/>
                  </svg>
                  <span>Code</span>
                  <p>Непрерывная разработка и&nbsp;управление жизненным циклом ПО</p>
                </a>
              </li>
              <li>
                <a href="/products/development-platform/">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 165 165" fill="none">
                    <path d="M82.2153 44.9685L49.2305 64.0212V102.127L82.2153 121.179L115.2 102.127V64.0212L82.2153 44.9685ZM99.2064 83.0407C99.2064 91.2536 92.5563 97.9038 84.3433 97.9038H69.4802V68.1776H84.3433C92.5563 68.1776 99.2064 74.8277 99.2064 83.0407Z" fill="black"/>
                    <path d="M107.744 0.954648L94.4131 14.2859L150.959 70.832L164.29 57.5007L107.744 0.954648Z" fill="#0064FF"/>
                    <path d="M56.6583 0.997428L0.87207 57.5483L14.2937 70.7885L70.08 14.2376L56.6583 0.997428Z" fill="#0064FF"/>
                    <path d="M13.4451 95.2148L0.200195 108.632L56.7553 164.461L70.0002 151.044L13.4451 95.2148Z" fill="#0064FF"/>
                    <path d="M150.99 95.1924L94.4346 151.022L107.679 164.439L164.235 108.609L150.99 95.1924Z" fill="#0064FF"/>
                  </svg>
                  <span>Development Platform</span>
                  <p>Управление разработкой через&nbsp;единое окно</p>
                </a>
              </li>
            </ul>
          </div>
            {%- else %}
              <a href="#">Products</a>
              <div class="sub-menu-container">
                <ul class="sub-menu sub-menu_products">
                  <li>
                    <a href="/products/kubernetes-platform/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#kubernetes-platform-icon"></use>
                      </svg>
                      <span>Kubernetes Platform</span>
                      <p>Creating identical Kubernetes clusters and&nbsp;managing them</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/virtualization-platform/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#virtualization-platform-icon"></use>
                      </svg>
                      <span>Virtualization Platform</span>
                      <p>Managing virtual machines</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/observability-platform/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#observability-platform-icon"></use>
                      </svg>
                      <span>Observability Platform</span>
                      <p>Infrastructure and&nbsp;application monitoring and&nbsp;logging</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/stronghold/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#stronghold-icon"></use>
                      </svg>
                      <span>Stronghold</span>
                      <p>Securely managing lifecycle of&nbsp;secrets</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/delivery-kit/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#delivery-icon"></use>
                      </svg>
                      <span>Delivery Kit</span>
                      <p>Building and&nbsp;delivering containerized software</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/commander/">
                      <svg class="products__icon">
                        <use xlink:href="/images/sprite.svg#commander-icon"></use>
                      </svg>
                      <span>Commander</span>
                      <p>Cluster control center</p>
                    </a>
                  </li>
                  <li>
                    <a href="/products/prompp/">
                      <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path id="Rectangle 75" d="M0.749023 13.9888H16.2508L15.7448 15.8522H1.25505L0.749023 13.9888Z" fill="#00003C"/>
                        <path id="Vector" d="M12.2239 17.8746V16.9834L4.79004 16.9834V17.8746L8.50699 20L12.2239 17.8746Z" fill="#00003C"/>
                        <path id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M15.1528 3.81515V12.8575H8.50695H1.86108V3.81515L8.50695 0L15.1528 3.81515ZM6.59876 9.84508H8.84374C10.0801 9.84508 11.0887 8.83209 11.0887 7.59038C11.0887 6.34866 10.0801 5.33568 8.84374 5.33568H6.59876V9.84508Z" fill="#0064FF"/>
                      </svg>
                      <span>Prom++</span>
                      <p>Open Source monitoring system</p>
                    </a>
                  </li>
                </ul>
              </div>
            {%- endif %}
          </li>
          {%- endunless %}
          {% for entry in topnav %}
            {% for item in entry.items %}
              {%- if site.mode == 'module' and item.ee_only and site.d8Revision != 'EE' %}{% continue %}{% endif %}
              {%- if item.title == site.data.i18n.common.products[page.lang] %}{% continue %}{% endif %}
              {%- assign page_url_without_lang = page.url | regex_replace: '^(/)?(ru/|en/)', '\1'-%}
              {%- assign item_url_parts = item.url | split: '/' -%}
              {%- assign is_getting_started_item = page_url_without_lang | startswith: '/gs/' -%}
              <li class="header__navigation-item
                {%- unless item.external_url.size > 0 %}
                {%- if page.mode == 'ssi' and site.mode != 'module' and item_url_parts[1] == 'documentation' %} header__navigation-item active{% endif %}
                {%- if page.mode != 'ssi' and is_getting_started_item and item.url == '/gs/' %} header__navigation-item active{% endif %}
                {%- if item.url.size>1 and page.url == item.url %} header__navigation-item active{% endif %}
                {%- if page_url_without_lang == item.url %} header__navigation-item active{% endif %}
                {%- if item.items %} current-menu-parent menu-item-has-children{% endif %}
                {%- if item.url.size<2 and page.url.size<2 %} header__navigation-item active{% endif %}
                {%- endunless %}"
                {%- if item.items %} data-proofer-ignore{% endif %}
              >
                <a
                  {%- if item.external_url %} href="{{ item.external_url }}"
                  {%- elsif item.url %} href="{% if site.mode == 'module' %}/{{ page.lang }}{% endif %}{{ item.url }}"
                  {%- else %} href="#"
                  {%- endif %}
                  {%- if item.target.size > 0 %} target="{{ item.target }}"{% elsif item.external_url.size > 0 %} target="_blank"{% endif %}>{{- item.title -}}
                </a>

                {% if item.items %}
                  <div class="sub-menu-container">
                    <ul class="sub-menu">
                      {% for subitem in item.items %}
                        {%- assign item_url_parts = subitem.url | split: '/' -%}
                        <li data-proofer-ignore>
                          <a
                            {%- if subitem.external_url %}
                              href="{{ subitem.external_url }}" {%- if !subitem.target %} target="_blank"{% endif %}
                            {%- elsif subitem.url %}
                              href="{% if site.mode == 'module' %}/{{ page.lang }}{% endif %}{{ subitem.url }}"
                            {%- else %}
                              href="#"
                            {% endif %}
                            {%- if subitem.target.size > 0 %} target="{{ subitem.target }}"{% endif %}
                            >
                              {{ subitem.title }}
                            </a>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
      <div class="header__right-box">
      </div>
    </div>
    {%- unless site.mode == "module" %}
    {%- assign l2MenuData = site.data.topnav-l2-products[page.lang] %}
    {%- if l2MenuData %}
    {%- assign productCode = page.product_code | default: "kubernetes-platform" %}
    {%- assign _conditionProductURL = "/products/" | append: productCode | append: "/" %}
    {%- assign productMenuData = l2MenuData | where: "url", _conditionProductURL | first %}
    {%- assign productLogoURL = "/images/sprite.svg#" | append: productCode | append: "-icon" %}
    {%- assign productName = productMenuData.title %}
    <div class="header header__product-menu">
      <div class="container">
        <div class="header__product-menu-logo">
          {%- if productName == "Code" %}
          <svg width="20" height="20" viewBox="0 0 280 280" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M208.947 41.7573L250.705 0H0V250.757L41.8106 208.757L41.927 41.9269L208.947 41.7573Z" fill="#00003C"/>
            <path d="M280 29.5309L238.447 71.2573L238.073 238.073L71.4473 238.088L29.5386 280H280V29.5309Z" fill="#00003C"/>
            <path d="M145.855 179.993H105.855V99.9932H145.855C167.884 99.9932 185.855 117.964 185.855 139.993C185.855 162.022 167.884 179.993 145.855 179.993Z" fill="#0064FF"/>
          </svg>
          {%- else %}
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <use xlink:href="{{ productLogoURL }}"></use>
          </svg>
          {%- endif %}
          <span>{{ productName }}</span>
        </div>
        <ul class="nav header__nav">
          {%- for item in productMenuData.items %}
            {%- if item.rel == "doc" %}{% assign itemClass='class="header__navigation-item active"' %}{% elsif item.title == "Возможности" %}{% assign itemClass='class="header__navigation-item menu-item-has-children"' %}{%- else %}{% assign itemClass='class="header__navigation-item"' %}{% endif %}
            <li {{ itemClass }} {%- if item.items %} data-proofer-ignore{% endif %}>
              <a href="{{ item.url }}"{% if item.target.size > 0 %} target="{{ item.target }}"{% endif %}>{{ item.title }}</a>
                {% if item.items %}
                  <div class="sub-menu-container">
                    <ul class="sub-menu">
                      {% for item in item.items %}
                        <li data-proofer-ignore><a href="{{ item.url }}">{{ item.title }}</a></li>
                      {% endfor %}
                    </ul>
                  </div>
              {% endif %}
            </li>
          {%- endfor %}
        </ul>
      </div>
    </div>
    {%- endif %}
    {%- endunless %}
  </header>
</div>
