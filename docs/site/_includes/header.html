{% assign topnav = site.data[page.topnav].topnav[page.lang] %}

<div class="header-container">
  <header class="header {%- if page.lang == 'ru' %} header_float{%- endif %}">
    <div class="header__content container">
      <div class="header__left-box">
        <ul id="top-header-nav" class="nav header__nav">
          <li class="header__navigation-item">
            <span style="font-size: 1.2em;padding-right: 5em;">Deckhouse Platform Certified Security Edition</span>
          </li>
          {% for entry in topnav %}
            {% for item in entry.items %}
              {%- if site.mode == 'module' and item.ee_only and site.d8Revision != 'EE' %}{% continue %}{% endif %}
              {%- if item.title == site.data.i18n.common.products[page.lang] %}{% continue %}{% endif %}
              {%- assign page_url_without_lang = page.url | regex_replace: '^(/)?(ru/|en/)', '\1'-%}
              {%- assign item_url_parts = item.url | split: '/' -%}
              {%- assign is_getting_started_item = page_url_without_lang | startswith: '/gs/' -%}
              <li class="header__navigation-item
                {%- unless item.external_url.size > 0 %}
                {%- if page.mode == 'ssi' and site.mode != 'module' and item_url_parts[1] == 'documentation' %} header__navigation-item active{% endif %}
                {%- if item.url == '/' %} header__navigation-item active{% endif %}
                {%- if page.mode != 'ssi' and is_getting_started_item and item.url == '/gs/' %} header__navigation-item active{% endif %}
                {%- if item.url.size>1 and page.url == item.url %} header__navigation-item active{% endif %}
                {%- if page_url_without_lang == item.url %} header__navigation-item active{% endif %}
                {%- if item.items %} current-menu-parent menu-item-has-children{% endif %}
                {%- if item.url.size<2 and page.url.size<2 %} header__navigation-item active{% endif %}
                {%- endunless %}"
                {%- if item.items %} data-proofer-ignore{% endif %}
              >
                <a
                  {%- if item.external_url %} href="{{ item.external_url }}"
                  {%- elsif item.url %} href="{{ item.url }}"
                  {%- else %} href="#"
                  {%- endif %}
                  {%- if item.target.size > 0 %} target="{{ item.target }}"{% elsif item.external_url.size > 0 %} target="_blank"{% endif %}>{{- item.title -}}
                </a>

                {% if item.items %}
                  <div class="sub-menu-container">
                    <ul class="sub-menu">
                      {% for subitem in item.items %}
                        {%- assign item_url_parts = subitem.url | split: '/' -%}
                        <li data-proofer-ignore>
                          <a
                            {%- if subitem.external_url %}
                              href="{{ subitem.external_url }}" {%- if !subitem.target %} target="_blank"{% endif %}
                            {%- elsif subitem.url %}
                              href="{{ subitem.url }}"
                            {%- else %}
                              href="#"
                            {% endif %}
                            {%- if subitem.target.size > 0 %} target="{{ subitem.target }}"{% endif %}
                            >
                              {{ subitem.title }}
                            </a>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
      <div class="header__right-box">
      </div>
    </div>
  </header>
</div>
