{% assign topnav = site.data[page.topnav].topnav[page.lang] %}

<div class="header-container">
  <header class="header">
    <div class="header__content container">
      <div class="header__left-box">
        <div class="header__logo">
          <a href="/documentation/v1/deckhouse-overview.html" class="header__logo">
            {%- if page.lang == "ru" %}
              <img src="{{ site.baseurl }}/images/logos/deckhouse-platform-dock-black-ru.svg" alt="Deckhouse" />
            {%- else %}
              <img src="{{ site.baseurl }}/images/logos/deckhouse-platform-dock-black.svg" alt="Deckhouse" />
            {%- endif %}
          </a>
          {%- if site.mode == 'local' %}
          <span class='updatechannel__content disable'>&nbsp;</span>
          {%- endif %}
        </div>
        <ul id="top-header-nav" class="nav header__nav">
          {% for entry in topnav %}
            {% for item in entry.items %}
              {%- if site.mode == 'local' and item.ee_only and site.d8Revision != 'EE' %}{% continue %}{% endif %}
              {%- assign item_url_parts = item.url | split: '/' -%}
              {%- assign is_getting_started_item = page_url_without_lang | startswith: '/gs/' -%}
              <li class="header__navigation-item
                {%- if page.mode == 'ssi' and site.mode != 'local' and item_url_parts[1] == 'documentation' %} header__navigation-item_active{% endif %}
                {%- if page.mode != 'ssi' and is_getting_started_item and item.url == '/gs/' %} header__navigation-item_active{% endif %}
                {%- if item.url.size>1 and page.url == item.url %} header__navigation-item_active{% endif %}
                {%- if page_url_without_lang == item.url %} header__navigation-item_active{% endif %}
                {%- if item.items %} current-menu-parent menu-item-has-children{% endif %}
                {%- if item.url.size<2 and page.url.size<2 %} header__navigation-item_active{% endif %}"
                {%- if item.items %} data-proofer-ignore{% endif %}
              >
                <a {% if item.url %}href="{{ item.url }}"{% else %}href="#"{% endif %}{% if item.target.size > 0 %} target="{{ item.target }}"{% endif %}>{{- item.title -}}</a>

                {% if item.items %}
                  <div class="sub-menu-container">
                    <ul class="sub-menu">
                      {% for subitem in item.items %}
                        {%- assign item_url_parts = subitem.url | split: '/' -%}
                        <li data-proofer-ignore class="submenu-item">
                          <a
                            {%- if subitem.external_url %}
                              href="{{ subitem.external_url }}"
                            {%- elsif subitem.url %}
                              href="{{ subitem.url }}"
                            {%- else %}
                              href="#"
                            {% endif %}
                              class="submenu-item-link menu-item menu-item-type-post_type menu-item-object-page"
                              target="_blank"
                            >
                              {{ subitem.title }}
                            </a>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          {% endfor %}
<!--          <li class="menu-item menu-item-type-custom menu-item-object-custom"><a>Быстрый старт</a></li>-->
<!--          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children "><a>Руководства</a>-->
<!--            <div class="sub-menu-container">-->
<!--              <ul class="sub-menu">-->
<!--                <li class="menu-item menu-item-type-post_type menu-item-object-page "><a href="https://deckhouse.ru.test.flant.com/services/managed/">Подготовка к production</a></li>-->
<!--              </ul>-->
<!--            </div>-->
<!--          </li>-->
<!--          <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="/documentation/v1/">Документация</a></li>-->
        </ul>
      </div>
      <div class="header__right-box">
        <ul class="header__navigation">
          <li class="header__navigation-item-icon">
            <a href="https://github.com/deckhouse/deckhouse" target="_blank">
              {% include icons/github.svg %}
            </a>
          </li>
          <li class="header__navigation-item header__navigation-item_parent submenu-parent {%- if page.no_alternative == true %} disabled{% endif %}" data-proofer-ignore>
            {%- if page.lang == "ru" %}
              <a class="language-button" href="
                {%- if site.mode == 'local' %}/en
                  {%- if page_url_without_lang %}{{ page_url_without_lang }}{% else %}/{%- endif %}
                {%- else -%}
                  {%- if page.mode == 'ssi' -%}
                    {{ site.urls['en'] }}{% raw %}{{ .MenuDocumentationLink }}{{ .CurrentPageURLRelative }}{% endraw %}
                  {%- else -%}
                    {{ site.urls['en'] }}{%- if page_url_without_lang %}{{ page_url_without_lang }}{% else %}/{%- endif %}
                  {%- endif %}
                {%- endif %}"
              >
                En
            {%- else %}
              <a class="language-button" href="
                {%- if site.mode == 'local' %}/ru
                  {%- if page_url_without_lang %}{{ page_url_without_lang }}{% else %}/{%- endif %}
                {%- else -%}
                  {%- if page.mode == 'ssi' -%}
                    {{ site.urls['ru'] }}{% raw %}{{ .MenuDocumentationLink }}{{ .CurrentPageURLRelative }}{% endraw %}
                  {%- else -%}
                    {{ site.urls['ru'] }}{%- if page_url_without_lang %}{{ page_url_without_lang }}{% else %}/{%- endif %}
                  {%- endif %}
                {%- endif %}"
              >
                Ru
            {%- endif %}
              </a>
          </li>
        </ul>
      </div>
    </div>
  </header>
</div>
