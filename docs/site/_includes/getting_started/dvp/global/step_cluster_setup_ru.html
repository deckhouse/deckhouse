{%- include getting_started/global/partials/NOTICES.liquid %}

## Укажите параметры кластера

<div class="form">
{%- if page.platform_type == 'dvp' %}
  <h3>Сетевые настройки кластера</h3>

  <div class="form__row">
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите подсеть узлов кластера">
          Подсеть узлов кластера (internalNetworkCIDRs) <span style="color: red;">*</span>
        </label>
        <input class="textfield"
          type="text" id="internalnetworkcidrs"
          name="internalnetworkcidrs" placeholder="Например, 10.10.0.0/16"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите подсеть в формате CIDR (например, <code>10.10.0.0/16</code>). Это обязательное поле.</span>
        <span class="info">
          Подсеть, используемая для узлов кластера. Должна покрывать все IP-адреса узлов кластера. Это обязательное поле. Убедитесь, что подсеть не пересекается с другими подсетями (подсетями подов, сервисов и виртуальных машин).
        </span>
      </div>
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите подсеть виртуальных машин">
          Подсеть виртуальных машин (virtualMachineCIDRs) <span style="color: red;">*</span>
        </label>
        <input class="textfield"
          type="text" id="virtualmachinecidrs"
          name="virtualmachinecidrs" placeholder="Например, 10.10.0.0/16"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите подсеть в формате CIDR (например, <code>10.20.0.0/16</code>). Это обязательное поле.</span>
        <span class="info">
          Подсеть, используемая для виртуальных машин в кластере. Это обязательное поле. Убедитесь, что подсеть не пересекается с другими подсетями.
        </span>
      </div>
    </div>
  </div>

  <div class="form__row">
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите подсеть подов кластера">
          Подсеть подов (podSubnetCIDR)
        </label>
        <input class="textfield"
          type="text" id="podsubnetcidr"
          name="podsubnetcidr" placeholder="10.115.0.0/16"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите подсеть в формате CIDR (например, <code>10.115.0.0/16</code>).</span>
        <span class="info">
          Подсеть, используемая для назначения IP-адресов подам (контейнерам) в кластере. По умолчанию: <code>10.115.0.0/16</code>. Если не указано, будет использовано значение по умолчанию.
        </span>
      </div>
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите подсеть сервисов кластера">
          Подсеть сервисов (serviceSubnetCIDR)
        </label>
        <input class="textfield"
          type="text" id="servicesubnetcidr"
          name="servicesubnetcidr" placeholder="10.225.0.0/16"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите подсеть в формате CIDR (например, <code>10.225.0.0/16</code>).</span>
        <span class="info">
          Подсеть, используемая для назначения IP-адресов сервисам Kubernetes (ClusterIP). По умолчанию: <code>10.225.0.0/16</code>. Если не указано, будет использовано значение по умолчанию.
        </span>
      </div>
    </div>
  </div>

  <div class="form__row">
    <div style="flex: 1; min-width: 250px;">
      <label class="label" title="Укажите IP-адрес worker-узла">
        IP-адрес worker-узла <span style="color: red;">*</span>
      </label>
      <input class="textfield"
        type="text" id="workernodeip"
        name="workernodeip" placeholder="192.168.1.11"
        autocomplete="off" />
      <span class="info invalid-message invalid-message-main">Введите IP-адрес worker-узла. Это обязательное поле.</span>
      <span class="info">
        IP-адрес worker-узла кластера. Это обязательное поле.
      </span>
    </div>
  </div>

  <h3>Настройки DNS</h3>

  <div class="form__row">
    <label class="label" title="Укажите шаблон DNS, который будет использовать кластер">
      Шаблон для DNS-имен кластера
    </label>
    <input class="textfield"
      type="text" id="clusterdomain"
      name="domain" placeholder="%s.domain.my"
      autocomplete="off" />
    <span class="info invalid-message invalid-message-main">Введите шаблон доменного имени, содержащий <code>%s</code>, например <code>%s.domain.my</code> или <code>%s-kube.domain.my</code>. Пожалуйста, не используйте домен <code>example.com</code>.</span>
    <span class="info invalid-message invalid-message-example-com">Пожалуйста, не используйте домен <code>example.com</code> в шаблоне.</span>
    <span class="info">
      Используется для формирования доменов системных приложений в кластере. Например, Grafana для шаблона <code>%s.domain.my</code> будет доступна как <code>grafana.domain.my</code>.<br />
      В данном руководстве предполагается использование публичного домена, направленного на публичный адрес кластера.
      Это необходимо для получения сертификатов <a href="https://letsencrypt.org/">Let's Encrypt</a> сервисам Deckhouse.
      В случае использования уже имеющихся сертификатов (в том числе самоподписанных) необходимо изменить параметры <a href="/products/kubernetes-platform/documentation/v1/reference/api/global.html#parameters-modules-https">секции <code>modules.https</code></a> в глобальных настройках.<br />
      Если у вас нет возможности завести wildcard-записи DNS, для тестирования вы можете воспользоваться, например, сервисом <a href="https://sslip.io/">sslip.io</a> или аналогами.
    </span>
  </div>

  <h3>Настройки NFS-хранилища</h3>

  <div class="form__row">
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 300px;">
        <label class="label" title="Укажите путь к экспортируемому каталогу на NFS-сервере, который будет использоваться для хранения данных">
          Путь к экспортируемому каталогу на NFS-сервере
        </label>
        <input class="textfield"
          type="text" id="nfsshare"
          name="nfsshare" placeholder="/srv/nfs/dvp"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите абсолютный путь к каталогу на NFS-сервере. Путь должен начинаться с <code>/</code> и содержать только буквы, цифры, дефисы, подчеркивания и слэши.</span>
        <span class="info">
          Абсолютный путь к экспортируемому каталогу на NFS-сервере. Используется для хранения метрик компонентов кластера (Prometheus) и дисков виртуальных машин. Пример: <code>/srv/nfs/dvp</code>. Каталог должен быть экспортирован через NFS и доступен для записи.
        </span>
      </div>
      <div style="flex: 1; min-width: 300px;">
        <label class="label" title="Укажите IP-адрес или hostname NFS-сервера">
          IP-адрес или hostname NFS-сервера
        </label>
        <input class="textfield"
          type="text" id="nfshost"
          name="nfshost" placeholder="192.168.1.100"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите IP-адрес (например, <code>192.168.1.100</code>) или hostname (например, <code>nfs.example.com</code>) NFS-сервера.</span>
        <span class="info">
          IP-адрес или доменное имя NFS-сервера, доступное из всех узлов кластера. Убедитесь, что сервер доступен по сети и порт NFS (обычно 2049) не заблокирован файрволом.
        </span>
      </div>
    </div>
  </div>

  <h3>Настройки доступа</h3>

  <div class="form__row">
    <label class="label" title="Укажите публичный SSH ключ пользователя caps для установки кластера">
      Публичный SSH ключ пользователя caps для установки кластера <span style="color: red;">*</span>
    </label>
    <input class="textfield"
      type="text" id="capssshkey"
      name="capssshkey" placeholder="ssh-rsa ..."
      autocomplete="off" />
    <span class="info invalid-message invalid-message-main">Введите публичный SSH ключ пользователя caps. Это обязательное поле.</span>
    <span class="info">
      Публичный SSH ключ пользователя caps, который будет использоваться для установки кластера. Ключ должен быть в формате OpenSSH (например, <code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB...</code>).
    </span>
  </div>

  <div class="form__row">
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите имя администратора по умолчанию">
          Имя администратора по умолчанию <span style="color: red;">*</span>
        </label>
        <input class="textfield"
          type="text" id="adminusername"
          name="adminusername" placeholder="admin"
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите имя администратора по умолчанию. Это обязательное поле.</span>
        <span class="info">
          Имя пользователя администратора, который будет создан в кластере по умолчанию.
        </span>
      </div>
      <div style="flex: 1; min-width: 250px;">
        <label class="label" title="Укажите пароль администратора по умолчанию">
          Пароль администратора по умолчанию <span style="color: red;">*</span>
        </label>
        <input class="textfield"
          type="password" id="adminpassword"
          name="adminpassword" placeholder=""
          autocomplete="off" />
        <span class="info invalid-message invalid-message-main">Введите пароль администратора по умолчанию. Это обязательное поле. Пароль должен содержать не менее 8 символов.</span>
        <span class="info">
          Пароль для пользователя администратора, который будет создан в кластере по умолчанию. Пароль должен быть достаточно надежным.
        </span>
      </div>
    </div>
  </div>
{%- endif %}
</div>

<script type="text/javascript">
{% include getting_started/dvp/global/partials/getting-started-setup.js.liquid %}
</script>
