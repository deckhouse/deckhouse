В данном руководстве представлены примеры шагов по установке Deckhouse Virtualization Platform. Руководство описывает минимальную конфигурацию платформы, которая включает следующие компоненты:

- **master-узел** — управляющий узел кластера, на котором запускаются системные компоненты Deckhouse и Kubernetes control plane. Master-узел отвечает за управление кластером, оркестрацию подов и координацию работы всех узлов.
- **worker-узел** — рабочий узел кластера, предназначенный для запуска рабочих нагрузок и виртуальных машин. На worker-узлах выполняются пользовательские приложения и виртуальные машины, созданные в платформе виртуализации.
- **NFS-сервер** — внешний сервер сетевого файлового хранилища, используемый для хранения дисков виртуальных машин и данных компонентов кластера (метрики, логи и т.д.). NFS-сервер обеспечивает централизованное хранилище, доступное со всех узлов кластера.

Такая конфигурация подходит для тестирования платформы и небольших рабочих нагрузок. Если вам нужна другая конфигурация (например, несколько master-узлов для высокой доступности, дополнительные worker-узлы или другое хранилище), ознакомьтесь с документацией по [установке платформы](../../documentation/admin/install/steps/prepare.html).

![Архитектура Deckhouse Virtualization Platform для быстрого старта](/images/virtualization-platform/dvp-architecture-gs.ru.png)

## Что необходимо для установки

1. **Персональный компьютер.** Компьютер, с которого будет производиться установка. Он нужен только для запуска инсталлятора и не будет частью кластера.

   Системные требования:

   - ОС: Windows 10+, macOS 10.15+, Linux (Ubuntu 20.04+, Fedora 35+);
   - установленный Docker для запуска инсталлятора Deckhouse (инструкции для [Ubuntu](https://docs.docker.com/engine/install/ubuntu/), [macOS](https://docs.docker.com/desktop/mac/install/), [Windows](https://docs.docker.com/desktop/windows/install/)).

   Требования к сети и доступам:

   - HTTPS-доступ до хранилища образов контейнеров `registry.deckhouse.ru`;
   - SSH-доступ по ключу до узла, который будет **master-узлом** будущего кластера;
   - SSH-доступ по ключу до узла, который будет **worker-узлом** будущего кластера.

1. **Физический сервер или виртуальная машина для master-узла.**

   Системные требования:

   - не менее 4 ядер CPU;
   - не менее 8 ГБ RAM;
   - не менее 60 ГБ дискового пространства на быстром диске (400+ IOPS);
   - [поддерживаемая ОС](/products/virtualization-platform/documentation/about/requirements.html#поддерживаемые-ос-для-узлов-платформы);
   - ядро Linux версии `5.8` или новее;
     {% offtopic title="Как проверить версию ядра" %}

     Чтобы проверить версию ядра, выполните следующую команду:

     ```bash
     uname -r
     ```

     {% endofftopic %}

   - поддержка `CgroupsV2`;

     {% offtopic title="Как проверить поддержку CgroupsV2" %}

     Чтобы проверить поддержку CgroupsV2, выполните следующую команду:

     ```bash
     stat -f -c %T /sys/fs/cgroup
     ```

     Если команда выведет `cgroup2fs`, то CgroupsV2 поддерживается.

     {% endofftopic %}

   - systemd версии `244` и новее;

     {% offtopic title="Как проверить версию systemd" %}

     Чтобы проверить версию systemd, выполните следующую команду:

     ```bash
     systemctl --version | awk 'NR==1{print $2}'
     ```

     {% endofftopic %}

   - поддержка модуля ядра `erofs`;

     {% offtopic title="Как проверить поддержку модуля ядра erofs" %}
     Чтобы проверить поддержку модуля ядра erofs, выполните следующую команду:
     ```bash
     modprobe -qn erofs && echo "Модуль erofs доступен" || echo "Модуль erofs недоступен"
     ```

     {% endofftopic %}

   - на узле не должно быть установлено пакетов container runtime, например containerd или Docker;

     {% offtopic title="Как проверить отсутствие container runtime" %}

     Чтобы проверить отсутствие container runtime, выполните следующие команды:

     ```bash
     systemctl is-active --quiet containerd && echo "containerd запущен" || echo "containerd не запущен"
     systemctl is-active --quiet docker && echo "Docker запущен" || echo "Docker не запущен"
     ```

     Оба сервиса должны быть не запущены.

     {% endofftopic %}

   - на узле должны быть установлены пакеты `cloud-utils` и `cloud-init`.

   Требования к сети и доступам:

   - CPU с архитектурой x86_64 с поддержкой инструкций Intel-VT (VMX) или AMD-V (SVM);
 
     {% offtopic title="Как проверить поддержку виртуализации CPU" %}
 
     Чтобы проверить поддержку виртуализации CPU, выполните следующую команду:

     ```bash
     grep -E 'vmx|svm' /proc/cpuinfo
     ```

     Если команда выведет строки с `vmx` (Intel-VT) или `svm` (AMD-V), то виртуализация поддерживается.

     {% endofftopic %}

   - **уникальный hostname** в пределах серверов (виртуальных машин) кластера;
   - HTTPS-доступ до хранилища образов контейнеров `registry.deckhouse.ru`;
   - доступ к стандартным для используемой ОС репозиториям пакетов;
   - SSH-доступ от **персонального компьютера** (см. п.1) по ключу;
   - сетевой доступ от **персонального компьютера** (см. п.1) по порту `22/TCP`.

1. **Физический сервер или виртуальная машина для worker-узла.**

   Требования аналогичны требованиям к master-узлу, но также зависят от характера запускаемой на узлах нагрузки.

1. **Физический сервер или виртуальная машина для NFS-сервера.**

   Системные требования:

   - [поддерживаемая ОС](/products/virtualization-platform/documentation/about/requirements.html#поддерживаемые-ос-для-узлов-платформы) с возможностью установки NFS-сервера;
   - достаточный объём дискового пространства под диски виртуальных машин.

   Требования по доступам и сети:

   - сетевой доступ по протоколу NFS (рекомендуется NFSv4.1) с master- и worker-узлов;
   - экспорт каталога для DVP с опцией `no_root_squash`;
   - SSH-доступ от **персонального компьютера** (см. п.1) по ключу для администрирования NFS-сервера.
