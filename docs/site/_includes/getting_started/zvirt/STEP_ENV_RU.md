{%- include getting_started/global/partials/NOTICES_ENVIRONMENT.liquid %}

Чтобы развернуть Deckhouse Kubernetes Platform на zVirt, необходимо выполнить некоторые предварительные настройки в системе виртуализации.

Выполните следующие шаги:

- Подготовка образа операционной системы

Вендоры операционных систем обычно предоставляют специальные cloud-сборки своих операционных систем для использования в среде виртуализации. Эти сборки, как правило, содержат драйверы для виртуального оборудования, cloud-init, гостевые агенты систем виртуализации и распространяются в виде образов дисков в форматах .img или .qcow2. Мы рекомендуем использовать такие cloud-образы в качестве ОС на нодах ваших кластеров.

Cloud-образ операционной системы должен быть размещен в хранилище дисков zVirt

1. Перейдите в портал администрирования zVirt -> Хранилище -> Диски
2. Загрузите cloud-образ ОС в хранилище

![ Начало загрузки cloud-образ ОС в хранилище ](/gs/zvirt/step_env_01.png)
![ Загрузка cloud-образ ОС в хранилище ](/gs/zvirt/step_env_02.png)

3. Дождитесь окончания загрузки образа в хранилище. В столбце “Состояние” должен появиться статус “ОК”. На этом подготовка образа ОС завершена.

![ Окончание загрузки cloud-образ ОС в хранилище ](/gs/zvirt/step_env_03.png)

- Подготовка шаблона виртуальной машины

Для создания шаблона виртуальной машины, перейдите в раздел “Ресурсы -> Виртуальные машины” портала администрирования zVirt и создайте новую виртуальную машину со следующими параметрами:

Раздел “Общее”
> Шаблон: Blank
> Операционная система: в зависимости от ОС в cloud-образе
> Профиль нагрузки: Высокая производительность
> Виртуальные диски: Прикрепить -> Выберите загруженный ранее cloud-образ ОС, установите галочку “Загрузочный”. Другие диски создавать или прикреплять не нужно.

![ Общий раздел ](/gs/zvirt/step_env_04.png)

Сетевые интерфейсы прикреплять не нужно, Deckhouse создаст и настроит их на виртуальной машине самостоятельно во время установки.

![ Сетевые интерфейсы ](/gs/zvirt/step_env_05.png)

Раздел “Система”
> Установите параметры “Оперативная память (разделяемая)”, “Максимум памяти” и “Оперативная память (гарантированная)” в соответствии с системными требованиями Deckhouse: не менее 8192 MB. Параметр “Всего ЦП” не менее 4.

![ Система ](/gs/zvirt/step_env_06.png)

Остальные параметры оставьте по умолчанию, создайте виртуальную машину. Когда процесс создания ВМ закончится, создайте шаблон на ее основе:

Выберите в списке созданную ВМ и перейдите в окно создания нового шаблона

![ Создание ВМ ](/gs/zvirt/step_env_07.png)

Заполните параметры шаблона, обязательным является только название. Включите параметр “Запечатать шаблон”.

![ Параметры шаблона ](/gs/zvirt/step_env_08.png)

На время создания шаблона виртуальная машина и диск cloud-образа перейдут в состояние “Образ заблокирован”. Проверить что шаблон был успешно создан можно в разделе “Ресурсы -> Шаблоны”.

![ Проверка шаблона ](/gs/zvirt/step_env_09.png)


