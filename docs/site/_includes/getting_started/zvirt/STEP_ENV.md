{%- include getting_started/global/partials/NOTICES_ENVIRONMENT.liquid %}

Чтобы развернуть Deckhouse Kubernetes Platform на zVirt, необходимо выполнить предварительные настройки в системе виртуализации:
- [Подготовить образ операционной системы](#подготовка-образа-операционной-системы)
- [Подготовить шаблон виртуальной машины](#подготовка-шаблона-виртуальной-машины)

### Подготовка образа операционной системы

Вендоры операционных систем обычно предоставляют специальные cloud-сборки своих операционных систем для использования в среде виртуализации. Эти сборки, как правило, содержат драйверы для виртуального оборудования, cloud-init, гостевые агенты систем виртуализации и распространяются в виде образов дисков в форматах .img или .qcow2. Мы рекомендуем использовать такие cloud-образы в качестве ОС на нодах ваших кластеров.

Cloud-образ операционной системы должен быть размещен в хранилище дисков zVirt. Выполните следующие шаги для загрузки образа ОС в хранилище:

1. Перейдите в портал администрирования zVirt -> Хранилище -> Диски
2. Загрузите cloud-образ ОС в хранилище

   ![ Начало загрузки cloud-образ ОС в хранилище ](/images/gs/zvirt/step_env_en_01.png)

   ![ Загрузка cloud-образ ОС в хранилище ](/images/gs/zvirt/step_env_en_02.png)

3. Дождитесь окончания загрузки образа в хранилище. В столбце “Состояние” должен появиться статус “ОК”. На этом подготовка образа ОС завершена.

   ![ Окончание загрузки cloud-образ ОС в хранилище ](/images/gs/zvirt/step_env_en_03.png)

### Подготовка шаблона виртуальной машины

Для создания шаблона виртуальной машины, перейдите в раздел “Ресурсы -> Виртуальные машины” портала администрирования zVirt и создайте новую виртуальную машину со следующими параметрами:

- Раздел _Общее_
  - **Шаблон:** `Blank`
  - **Операционная система:** в зависимости от ОС в cloud-образе.
  - **Профиль нагрузки:** Высокая производительность.
  - **Виртуальные диски:** Прикрепить -> Выберите загруженный ранее cloud-образ ОС, установите галочку “Загрузочный”. Другие диски создавать или прикреплять не нужно.

    ![ Общий раздел ](/images/gs/zvirt/step_env_en_04.png)

  - Сетевые интерфейсы прикреплять не нужно, Deckhouse создаст и настроит их на виртуальной машине самостоятельно во время установки.

    ![ Сетевые интерфейсы ](/images/gs/zvirt/step_env_en_05.png)

- Раздел _Система_

  Установите параметры “Оперативная память (разделяемая)”, “Максимум памяти” и “Оперативная память (гарантированная)” в соответствии с системными требованиями Deckhouse: не менее 8192 MB. Параметр “Всего ЦП” — не менее 4-х.

  ![ Система ](/images/gs/zvirt/step_env_en_06.png)

- Остальные параметры оставьте по умолчанию, создайте виртуальную машину. Когда процесс создания ВМ закончится, создайте шаблон на ее основе:

  - Выберите в списке созданную ВМ и перейдите в окно создания нового шаблона.

    ![ Создание ВМ ](/images/gs/zvirt/step_env_en_07.png)

  - Заполните параметры шаблона, обязательным является только название. Включите параметр _Запечатать шаблон_:

    ![ Параметры шаблона ](/images/gs/zvirt/step_env_en_08.png)

На время создания шаблона виртуальная машина и диск cloud-образа перейдут в состояние _Образ заблокирован_. Проверить что шаблон был успешно создан можно в разделе _Ресурсы -> Шаблоны_:

![ Проверка шаблона ](/images/gs/zvirt/step_env_en_09.png)
