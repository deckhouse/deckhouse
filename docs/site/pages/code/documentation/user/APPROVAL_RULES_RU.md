---
title: "Правила апрувов запросов на слияние"
menuTitle: Правила апрувов запросов на слияние
force_searchable: true
description: Настройка правил апрувов
permalink: ru/code/documentation/user/approval-rules.html
lang: ru
weight: 50
---

Эта функция позволяет определить, сколько апрувов необходимо получить, чтобы смерджить запрос на слияние.
Правила апрувов дополняет механизм [CODEOWNERS](/products/code/documentation/user/code-owners.html) на странице запроса на слияние.

Правила можно определить на уровне:

- Группы (доступно для роли **Maintainer**)
- Проекта (доступно для роли **Maintainer**)
- Запроса на слияние (доступно для роли **Developer**)

![Таблица правил апрува](/images/code/approval_rules_ru.png)

### Описание столбцов

- **Правило** — содержит название правила и признак наследования. Запись «Требуется группой Gitlab Org» означает, что правило создано в группе *Gitlab Org*.
- **Апруверы** — содержит список пользователей и групп, чьи апрувы учитываются при проверке выполнения правила.
- **Требуемое количество апрувов** — количество апрувов, которое необходимо получить от пользователей или участников групп, указанных в апруверах. Значение «Любой подходящий пользователь» означает, что будет засчитан апрув от любого пользователя, который имеет право его выполнить.
- **Целевая ветка** — правило применяется только если запрос на слияние направлен в указанную ветку. В качестве названия ветки можно использовать wildcard (`*`).

---

### Наследование правил

Правила апрувов наследуются каскадно: группа → подгруппа → проект → запрос на слияние.

- Когда создаётся подгруппа, проект или запрос на слияние, правила родительской сущности автоматически появляются в новой сущности как унаследованные. В таблице правил рядом с названием отображается, на каком уровне правило было изначально создано.

- При создании новых правил на уровне группы или проекта они автоматически добавляются во все существующие нижестоящие подгруппы и проекты. **В уже созданные запросы на слияние новые правила не добавляются**

- Если изменить правило на родительском уровне, изменения автоматически применяются ко всем унаследованным правилам на нижестоящих уровнях. Например, если проект унаследовал правило из группы, и в группе изменить количество требуемых апрувов, то это изменение отразится и в проекте.

- Если же изменить унаследованное правило в дочерней сущности, **оно превращается в самостоятельное правило**. То есть правило перестаёт быть связанное с родительским: на дочернем уровне остаётся собственная копия с новыми параметрами, и дальнейшие изменения правила в группе уже не затронут это правило в проекте.

---

### Правила для группы

Правила, созданные на уровне группы, автоматически добавляются в новые проекты и подгруппы как унаследованные.

Управлять правилами группы могут участники группы с ролью **Maintainer**.  
Для перехода к настройкам правил на странице группы выберите:  
**Настройки → Запросы на слияние**.  

В разделе *Правила апрува* отображается список правил, настроенных на уровне группы.

#### Создание правила в группе

При нажатии кнопки **«Добавить правило апрува»** можно создать новое правило, указав:

- Название правила
- Целевую ветку (доступны пресеты «Все ветки», «Все защищенные ветки», «Ввести название ветки», либо wildcard `*`)
- Требуемое количество апрувов
- Апруверов — участников группы или группы на инстансе

---

### Правила для проекта

Правила, созданные на уровне проекта, автоматически добавляются в новые запросы на слияние как унаследованные.

Управлять правилами проекта могут участники проекта с ролью **Maintainer**.  
Для перехода к настройкам выберите:  
**Настройки → Запросы на слияние** → *Правила апрува*.

#### Создание правила в проекте

При создании нового правила можно указать:

- Название правила
- Целевую ветку (можно выбрать пресет, указать название ветки или regex; также можно выбрать защищённую ветку проекта)
- Требуемое количество апрувов
- Апруверов — прямых или унаследованных участников проекта, а также группы, приглашённые в проект с ролью **Reporter** или выше

---

### Правила для запроса на слияние

Правилами запроса на слияние могут управлять пользователи с ролью **Developer**.

Чтобы перейти к настройкам правил, на странице создания или редактирования MR необходимо раскрыть секцию **«Правила апрува»**.

![Таблица правил апрува](/images/code/approval_rules_mr.png)

На странице MR доступна кнопка **«Сбросить к настройкам проекта по умолчанию»** — она удаляет текущие правила и заново добавляет все правила проекта которые применимыц для целевой ветки MR.

#### Создание правила в MR

При создании правила можно указать:

- Название правила
- Требуемое количество апрувов
- Апруверов — прямых или унаследованных участников проекта, а также группы с ролью **Reporter** или выше

---

### Настройки апрувов

![Настройки апрувов](/images/code/approval_rules_settings_ru.png)

На уровне проекта или группы можно настроить дополнительные параметры:

- **Запретить апрув автору запроса на слияние** — автор MR не может делать апрув.
- **Запретить апрув пользователю, который добавил коммиты** — коммиттеры не могут делать апрувы.
- **Запретить редактирование правил в наследуемых сущностях** — при включении:
  - правила копируются в дочерние сущности и становятся недоступны для редактирования или удаления;
  - нижестоящие группы и проекты могут создавать только собственные правила;
  - в существующие MR правила автоматически не добавляются;
  - текущие настройки апрувов также распространяются на все дочерние сущности.
- **При добавлении коммита** — определяет, должны ли сбрасываться существующие апрувы при появлении нового коммита.

---

### Кто может делать апрувы

Если настройки апрувов это не запрещают, апрувы могут делать:

- мемберы проекта с ролью **Developer** и выше,
- автор запроса на слияние (если это не запрещено),
- назначенный ответственный за MR.
