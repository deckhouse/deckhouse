---
title: "Правила апрувов запросов на слияние"
menuTitle: Правила апрувов запросов на слияние
force_searchable: true
description: Настройка правил апрувов
permalink: ru/code/documentation/user/approval-rules.html
lang: ru
weight: 50
---

Эта функция позволяет определить сколько апрувов нужно получить для того что бы смерджить запрос на слияние.
Так же сущствует механизм [CODEOWNERS](/products/code/documentation/user/code-owners.html) который дополняет механизм правил апрува, но не заменяет их. В отличие от правил апрува, которые задаются вручную в UI, CODEOWNERS работает через файл CODEOWNERS в репозитории.

Правила можно определить на уровне:

- Группы (Доступно для уровня доступа - maintainer)
- Проекта (Доступно для уровня доступа - maintainer)
- Запроса на слияние (Доступно для уровня доступа - developer)

![Таблица правил апрува](/images/code/approval_rules_ru.png)

Описание столбцов:

- Правило - Содержит название правила и признак унаследованости. запись "Требуется группой Gitlab Org" Означает что это правило создано в группе "Gitlab Org"
- Аппруверы - Содержит список пользователей и групп, чьи апрувы будут учитыватся для соблюдения этого правила
- Требуемое количество апрувов - Количество аппрувов которые нужно получить от пользователей или участников групп указаных в апруверах. "Любой подходящий пользователь" означает что любой апрув от любого пользователя который может его делать будет учитываться.
- Целевая ветка - Правило будет применятся если запрос на слияние происходит в целевую ветку. В качестве целевой ветки может быть указан wildcard с *.

### Наследование правил

Правила апрува применяются каскадно группа -> подгруппа -> проект -> запрос на слияние

При создании подгрупп, проектов и запросов на слияние правила из родительской сущности добавляются в новую в виде ссылки. В таблице правил рядом с названием указывается группа или проект где правило было создано.

При редактировании правила которое наследуются дочернии сущности параметры правила будут применены в дочерних сущностях. Например если в проекте есть правило унаследованное из группы, то изменение количество требуемых апруверов на уровне группы также изменит правило в проекте.

Редактирование унаследованных правил - Если отредактировать унаследованное правило, то вместо ссылки на правило будет создана его копия с новыми параметрами. Например если в проекте есть правило унаследованное от группы то после его редактиования ссылка на правило из группы будет удалена а в проекте будет создано новое правило. Которое в дальнейшем не будет изменено при изменении оригинального правила.

Создание новых правил. При создании новых правил они будут автоматически добавлены в существующие нижестоящие подгруппы\проекты. В запросы на слияние добавлены не будут.

### Правила для группы

Правила на уровне группы будут добавлены в новые проекты и группы как наследуемые.

Правилами группы могут управлять участники группы с ролью maintainer.
Что бы перейти к настройкам правил находясь на странице группы в левом меню необходимо выбрать Настройки -> Запросы на слияние.
Тут в разделе *Правила апрува* можно увидеть список правил настроенных на уровне группы.

#### Создание правила на уровне группы

При нажатии кнопку "Добавить правило апрува" Можно создать новое правило заполнив следующие поля

- Название правила
- Целевая ветка - Можно выбрать пресет "Все ветки", "Все защищенные ветки", "Ввести название ветки" и в появившемся текстовом поле указать название ветки или wildcard с *.
- Требуемое количество апрувов - количество апрувов которое необходимо получить от разрешенных апруверов этого правила
- Аппруверы - Могут быть добавлены участники группы или группы на инстансе.

### Правила для проекта

Правила на уровне проекта будут добавлены в новые запросы на слияния как наследуемые.

Правилами группы могут управлять участники проекта с ролью maintainer.
Что бы перейти к настройкам правил находясь на странице проекта в левом меню необходимо выбрать Настройки -> Запросы на слияние.
Тут в разделе *Правила апрува* можно увидеть список правил настроенных на уровне проекта.

#### Создание правила на уровне проекта

При нажатии кнопку "Добавить правило апрува" Можно создать новое правило заполнив следующие поля

- Название правила
- Целевая ветка - Можно выбрать пресет "Все ветки", "Все защищенные ветки", "Ввести название ветки" и в появившемся текстовом поле указать название ветки или regex. Также начав ввод названия защищенной ветки может быть выбрана защищенная ветка из этого проекта.
- Требуемое количество апрувов - количество апрувов которое необходимо получить от разрешенных апруверов этого правила
- Аппруверы - Могут быть добавлены прямые или унаследованные участники  проекта. А также группы приглашенные в проект с ролью Reporter и выше.

### Правила для запроса на слияние

Правилами запроса на слияние могут управлять пользователи с ролью developer.
Что бы перейти к настройкам правил для запроса на слияние на странице создания или редактирования запроса на слияние необходмо раскрыть секцию "Правила аппрува"
![Таблица правил апрува](/images/code/approval_rules_mr.png)

На странице создания или редактирования Запроса на слияние есть кнопка "Сбросить к настройкам проекта по умолчанию" Эта кнопка удалит существующие правила и добавит все правила из проекта.

#### Создание правила на уровне запроса на слияние

При нажатии кнопку "Добавить правило апрува" Можно создать новое правило заполнив следующие поля

- Название правила
- Требуемое количество апрувов - количество апрувов которое необходимо получить от разрешенных апруверов этого правила
- Аппруверы - Могут быть добавлены прямые или унаследованные участники  проекта. А также группы приглашенные в проект с ролью Reporter и выше.

### Настройки апрувов

![Настройки апрувов](/images/code/approval_rules_settings_ru.png)

На странице проекта или группы можно установить настройки апрувов.

- Запретить апрув автору запроса на слияние - Если включено автор запроса на слияние не может делать апрув
- Запретить апрув пользователю, который добавил коммиты -  Если включено то коммиттеры не могут делать апрувы
- Запретить редактирование правил апрува в наследуемых сущностях. Когда включено правила будут скопированы в дочерние сущности - Если включено то все нижестоящие сущности не могут удалять или редактировать правила созданные на этом уровне. Только создавать новые. Включение этой опции также добавит эти правила во все нижестоящие группы и проекты. В существующие запросы на слияние правила добавлены не будут. Включение этой опции также применит текущие настройки апрувов во все нижестоящие сущности и запретит их редактировать в дочерних группах и проектах.
- При добавлении коммита - определяет должны ли сбрасываться существующие апрувы в запросе на слияние при добавлении нового коммита

### Кто может делать апрувы

Если не запрещено настройками апрувов апрувы могут делать мемберы проекта с ролью developer. А также мембер проекта который является автором запроса на слияние или назначен ответственным
