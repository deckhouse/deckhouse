{% assign productCode = include.productCode -%}
{"documents":[
{%- assign searchedpages = site.pages | where: "searchable", true | where: "lang", page.lang %}
{%- for page in searchedpages %}
{%- if page.name == 'CR.md' or page.name == 'CR_RU.md' or page.name == 'CONFIGURATION.md' or page.name == 'CONFIGURATION_RU.md' or page.name == 'CLUSTER_CONFIGURATION.md' or page.name == 'CLUSTER_CONFIGURATION_RU.md' %}{% continue %}{% endif %}
{%- assign bc_items = page | get_breadcrumb_titles: page.sidebar -%}
{"title": "{{ page.title | escape }}",
"url": "{{ page.url | remove_first: "/" | regex_replace: '^(ru/|en/)', '' }}",
"keywords": {{ page.search | jsonify }},
"bc": {{ bc_items | jsonify }},
"content": {{ page.content | normalizeSearchContent | jsonify -}}
}
{%- unless forloop.last %},{% endunless %}
{%- endfor -%}
{%- assign faqpages = site.pages | where: "faqIndexPage", true | where: "lang", page.lang %}
{%- for faqpage in faqpages %}
,{"title": "{{ faqpage.title | escape }}",
"url": "{{ faqpage.url | remove_first: "/" | regex_replace: '^(ru/|en/)', '' }}",
"keywords": {{ faqpage.search | jsonify }},
"content": {{ faqpage.description | jsonify }} }
{%- endfor -%}
{%- assign searchedpages = site.faq | where: "searchable", true | where: "lang", page.lang %}
{%- if faqpages.size > 0 and searchedpages.size > 0 %},{% endif %}
{%- for page in searchedpages %}
{"title": "{{ page.title | escape }}",
"url": "faq.html#{{ page.title | slugify | truncate: 64, "" }}",
"keywords": {{ page.search | jsonify }},
"bc": ["FAQ"],
"content": {{ page.content | normalizeSearchContent | jsonify -}}
}
{%- unless forloop.last %},{% endunless %}
{%- endfor -%}
],
"parameters":[
{%- for item in site.data.search.searchItems[page.lang] %}
{%- assign page_canonical_url = item.url | relative_url %}
{%- assign keywords = "" %}
{%- if item.search.size > 0 %}
  {%- if keywords.size > 0 %}
    {%- assign keywords = item.search | append: ", " | append: keywords %}
  {%- else %}
    {%- assign keywords = item.search %}
  {%- endif %}
{%- endif %}
{
"name": "{{ item.name }}",
"module": "{{ item.module | default: "global" }}",
"moduletype": "embedded",
"url": "{{ page_canonical_url }}",
"resName": "{{ item.resourceName | escape }}",
{%- if item.isResource %}
"isResource": "true",
{%- endif %}
{%- if item.deprecated %}
"deprecated": "true",
{%- endif %}
{%- if keywords.size > 0 %}
"keywords": {{ keywords | jsonify }},
{%- endif %}
"path": "{{ item.pathString | escape }}",
"content": {{ item.content | default: '' | normalizeSearchContent | jsonify -}}
}
{%- unless forloop.last %},{% endunless %}
{%- endfor -%}
]}
