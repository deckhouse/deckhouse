---
title: Геораспределённость
permalink: ru/architecture/geo-distribution.html
lang: ru
---

**Геораспределенность** в контексте катастрофоустойчивости Deckhouse Kubernetes Platform — архитектурный подход, обеспечивающий отказоустойчивость и непрерывность работы кластера за счет распределения его компонентов по нескольким [зонам доступности (Multi-AZ)](#использование-нескольких-зон-доступности-multi-az) или [нескольким регионам (Multi-Region)](#использование-нескольких-регионов-multi-region) для минимизации рисков аварий различных масштабов (геораспределенный кластер).

{% alert level="warning" %}
При использовании этого подхода важно обеспечить сетевую связанность между узлами кластера. Об этом должен позаботиться администратор платформы.
{% endalert %}

## Использование нескольких зон доступности (Multi AZ)

Deckhouse Kubernetes Platform предоставляет возможность распределения узлов кластера по зонам доступности.
Это повышает устойчивость приложений к сбоям на уровне инфраструктуры, обеспечивая их работоспособность даже при недоступности одной из зон в ЦОДе или облаке.

**Зона доступности (Availability Zone, AZ)** — базовая единица катастрофоустойчивой архитектуры. AZ представляет собой логическую группу из одного или нескольких ЦОДов, расположенных на расстоянии нескольких километров друг от друга, которую можно рассматривать как изолированную единицу. Для пользователя AZ выглядит как единый виртуальный дата-центр, хотя физически это распределённая инфраструктура. Зоны доступности входят в состав [регионов](#использование-нескольких-регионов-multi-region).

### Характеристики и отличительные особенности зон доступности

Зоны доступности имеют следующие характеристики и отличительные особенности:

- разнесение ЦОДов внутри AZ на достаточное расстояние (обычно ≤10 км), чтобы избежать общего воздействия (например, наводнения или пожара), но при этом обеспечить низкую задержку;
- независимое электроснабжение для компонентов, образующих зону доступности (разные электрические подстанции, дизель-генераторы и т.д.);
- использование компонентами зоны разных провайдеров и маршрутов;
- относительно невысокая задержка внутри зоны.

### Распределение узлов по зонам в Deckhouse Kubernetes Platform

В большинстве облачных решений этот процесс происходит автоматически. Но при работе вне облаков потребуется явная маркировка узлов с помощью лейблов с указанием идентификатора зоны. Администраторы платформы должны обеспечить корректную маркировку.

Процесс маркировки узлов лейблами и их добавления в группы узлов описан в разделе [Управление узлами](../admin/configuration/platform-scaling/node-management.html).

## Использование нескольких регионов (Multi Region)

Deckhouse Kubernetes Platform предоставляет возможность распределения узлов кластера по разным регионам.
Это повышает устойчивость приложений к катастрофам, обеспечивая их работоспособность даже при выходе из строя целого ЦОДа или облака.

**Регион (Region)** — независимая географическая область, состоящая из нескольких (минимум 3 у большинства провайдеров) изолированных [зон доступности (AZ)](#использование-нескольких-зон-доступности-multi-az), объединённых в единую логическую инфраструктурную единицу с общими сервисами управления. Регион — ключевой элемент глобальной распределённой архитектуры облачных провайдеров.

*Использование нескольких регионов (Multi Region) обычно подходит только для ситуаций, когда приложения могут функционировать в каждом регионе автономно (не обращаясь к другим регионам). Это обусловлено относительно высокой задержкой (Latency) между регионами. Например, размещение кеширующих серверов для CDN или узлов распределенного мониторинга.*

### Характеристики и отличительные особенности регионов

Регионы имеют следующие характеристики и отличительные особенности:

- Разница в задержке внутри региона и между регионами. Если внутри региона задержка при передаче данных от AZ до AZ может составлять около 5 мс, то между регионами — от 50 до 200 мс.
- Географическая удалённость. Регионы могут быть существенно удалены друг от друга (например, расстояние между `europe-west3` (Франкфурт) и `us-east-1` (Вирджиния) — ~6500 км).
- Физическая безопасность. Провайдеры стараются размещать регионы вне зон сейсмической или политической нестабильности.
- Энергетическая избыточность. Регионы, как правило, подключаются к нескольким национальным энергосетям (например, `me-central-1` (ОАЭ) использует 4 независимых источника).

### Распределение узлов по разным регионам в Deckhouse Kubernetes Platform

Для распределения узлов разным регионам необходима маркировка узлов специальными лейблами и наличие стабильных каналов связи между регионами. Администраторы платформы должны гарантировать наличие на каждом узле лейбла, указывающего, в каком регионе он расположен.

Процесс маркировки узлов лейблами и их добавления в группы узлов описан в разделе [Управление узлами](../admin/configuration/platform-scaling/node-management.html).

## Балансировка входящего трафика в геораспределенном кластере

Для обеспечения катастрофоустойчивости в геораспределенном кластере балансировка трафика может быть организована с помощью балансировщика от облачного провайдера, а также средствами внутреннего балансировщика (например средствами MetalB). Она настраивается администратором кластера. Подробнее о вариантах балансировки и их настройках — в разделе [Сеть](../admin/network/overview.html).

## Организация хранилища в геораспределенных кластерах

За организацию и настройку хранилища в геораспределенных кластерах отвечает администратор. В Deckhouse Kubernetes Platform поддерживаются разные системы хранения (хранилища). Выбор подходящего варианта зависит от ваших потребностей. Подробнее о системах хранения, их особенностях и настройке — в разделе [Хранение](../admin/storage/overview.html).
