---
title: Режимы обновлений
permalink: ru/admin/platform-update/modes.html
lang: ru
---

Deckhouse Kubernetes Platform поддерживает два режима обновления минорных версий (релизов). От выбора режима зависит порядок обновления:

1. **Auto** (автоматический)
   * Все минорные обновления (v1.X.* → v1.Y.*) устанавливаются автоматически.
   * Установка проходит с учётом окон обновлений (!!!!link), если они заданы. Если окна не определены, обновление выполняется сразу после выхода новой версии на канале обновлений.
1. **Manual** (ручной)
   * Все минорные обновления требуют ручного подтверждения.
   * Для применения обновления необходимо установить поле `approved` в значение `true` в Custom Resource `DeckhouseRelease`.

Если режим обновления не задан, то по умолчанию используется режим обновления `Auto`.

## Сценарии обновлений

1. Автоматический режим без заданных окон обновлений - кластер обновится сразу после выхода новой минорной версии на канале обновлений.
1. Автоматический режим с заданными окнами обновлений - кластер обновится в ближайшее доступное окно после появления новой версии.
1. Ручной режим - установка каждой минорной версии требует вашего подтверждения.

## Пример ручного обновления

Чтобы обновить Deckhouse Kubernetes Platform до v1.68.0 в ручном режиме, выполните команду:

```bash
kubectl patch DeckhouseRelease v1.68.0 --type=merge -p='{"approved": true}'
```

## Настройка параметра update.disruptionApprovalMode

Некоторые минорные релизы могут содержать потенциально опасные (disruptive) изменения, влияющие на базовые настройки и работу модулей. Для управления обновлением таких релизов служит параметр `update.disruptionApprovalMode`:
1. Auto (автоматический) - Минорные потенциально опасные обновления устанавливаются без дополнительного подтверждения. 
1. Manual (ручной)
   * Каждое потенциально опасное минорное обновление Deckhouse Kubernetes Platform требует ручного подтверждения.
   * Для этого необходимо добавить аннотацию `release.deckhouse.io/disruption-approved=true` к соответствующему ресурсу `DeckhouseRelease`.

По умолчанию используется режим `Auto`.
