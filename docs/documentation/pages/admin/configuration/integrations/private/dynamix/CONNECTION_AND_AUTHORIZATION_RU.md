---
title: Подключение и авторизация
permalink: ru/admin/integrations/private/dynamix/dynamix-authorization.html
lang: ru
---

{% alert level="info" %}
Интеграция с Dynamix находится в экспериментальном режиме. Совместимость с будущими версиями не гарантируется, поведение может измениться.
{% endalert %}

Возможности интеграции включают:

- заказ и удаление виртуальных машин через API DynamiX;
- использование подготовленных cloud-образов для развёртывания узлов;
- настройку параметров виртуальных машин (CPU, RAM, диск, сеть);
- поддержку внешней и внутренней сетей, включая настройку CIDR и DNS;
- работу с несколькими схемами размещения — с внешней или комбинированной сетью;
- управление хранением данных через pool и storage endpoint.

## Требования

{% alert level="warning" %}
Провайдер поддерживает работу только с одним диском в шаблоне виртуальной машины. Убедитесь, что шаблон содержит только один диск.
{% endalert %}

Для интеграции Deckhouse Kubernetes Platform (DKP) с Dynamix необходимы:

- доступ к API-контроллеру и SSO-контур Dynamix;
- данные учётной записи (account) и параметры приложения (`appId` и `appSecret`);
- размещённый в облаке cloud-образ операционной системы;
- внешняя сеть (`externalNetwork`) и, при необходимости, параметры внутренней сети (CIDR, DNS);
- сведения о хранилище (pool и storage endpoint);
- публичный SSH-ключ для доступа к узлам кластера.

## Подготовка cloud-образа

Для развёртывания виртуальных машин DKP использует cloud-образы операционных систем, подготовленные вендорами для работы в виртуальной среде. Эти образы, как правило, включают:

- `cloud-init`;
- драйверы виртуального оборудования;
- гостевые агенты.

Рекомендуется использовать официальные cloud-образы, распространяемые в форматах `.img`, `.qcow2` и аналогичных.

Чтобы добавить образ в Dynamix:

1. Перейдите в раздел «Образы» → «Шаблонные образы».
1. Загрузите подготовленный cloud-образ.

## Настройка доступа к порталу

Если в вашей инфраструктуре отсутствует DNS-сервер, добавьте IP-адреса и домены портала Dynamix вручную в шаблон `cloud-init`, чтобы обеспечить корректную работу системы при запуске узлов.

1. Отредактируйте шаблон файла `hosts`, расположенный в каталоге:

   ```console
   /etc/cloud/templates/
   ```

1. Добавьте соответствующие записи IP-адресов и доменных имен, характерные для вашей операционной системы и конфигурации. Это может включать записи для портала Dynamix, такие как:

   ```txt
   <IP-адрес> <доменное имя>
   ```

1. После изменений выполните очистку состояния `cloud-init`:

   ```console
   cloud-init clean
   ```

1. Создайте шаблон на основе подготовленной виртуальной машины. Это необходимо для корректной генерации файла `/etc/hosts` на этапе первого запуска.
