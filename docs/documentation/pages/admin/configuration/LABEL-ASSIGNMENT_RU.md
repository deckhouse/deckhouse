---
title: Автоматическое назначение лейблов и аннотаций пространствам имён
permalink: ru/admin/configuration/label-assignment.html
lang: ru
---

Вы можете автоматизировать назначение лейблов и аннотаций пространствам имён в кластере Deckhouse
на основе заданных шаблонов.
Это может быть полезно, например, для автоматического добавления новых пространств имён в мониторинг,
без необходимости вручную редактировать каждое пространство имён.

## Как это работает

- Все пространства имён, чьи названия совпадают с шаблонами в `includeNames` и не совпадают с шаблонами в `excludeNames`,
  получают указанные лейблы и аннотации.
- При изменении конфигурации лейблы и аннотации на существующих пространствах имён обновляются автоматически.
- Новые пространства имён, подходящие под условия шаблонов, также получают нужные лейблы и аннотации автоматически.

## Настройка автоматического назначения лейблов и аннотаций

1. Создайте ресурс ModuleConfig с именем [`namespace-configurator`](../../reference/mc/namespace-configurator),
   описывающий желаемые параметры и шаблоны.
1. В полях `annotations` и `labels` перечислите аннотации и лейблы, которые должны применяться к пространствам имён.
1. Укажите шаблоны названий пространств имён, к которым должны применяться параметры:
   - в поле `includeNames` перечислите регулярные выражения, соответствующие нужным названиям;
   - в поле `excludeNames` перечислите те, которые нужно исключить.
1. Примените созданную конфигурацию командой `d8 k apply`.

## Пример конфигурации

В следующем примере применяется конфигурация,
которая автоматически добавляет лейбл `extended-monitoring.deckhouse.io/enabled=true` и аннотацию `foo=bar`
ко всем пространствам имён, названия которых начинаются с `prod-` или `infra-`, за исключением `infra-test`.

```shell
d8 k apply -f - <<EOF
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: namespace-configurator
spec:
  version: 1
  enabled: true
  settings:
    configurations:
    - annotations:
        foo: bar
      labels:
        extended-monitoring.deckhouse.io/enabled: "true"
      includeNames:
      - "^prod"
      - "^infra"
      excludeNames:
      - "infra-test"
EOF
```
