---
title: "Межкластерное взаимодействие (альянс)"
permalink: ru/admin/configuration/network/alliance/
lang: ru
---

<!-- перенесено с небольшими изменениями из https://deckhouse.ru/products/kubernetes-platform/documentation/latest/modules/istio/#%D1%84%D0%B5%D0%B4%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B8-%D0%BC%D1%83%D0%BB%D1%8C%D1%82%D0%B8%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80 -->

В Deckhouse Kubernetes Platform поддерживаются две схемы межкластерного взаимодействия:

- [федерация](../alliance/federation.html);
- [мультикластер](../alliance/multicluster.html).

Обе схемы могут быть реализованы средствами Istio (модуль [`istio`](../../../../modules/istio/)) или Cilium (модуль [`cni-cilium`](../../../../modules/cni-cilium/)), которые позволяют развернуть service mesh (далее — сервис-меш) для контроля того, как приложения, развернутые в кластере, обмениваются данными между собой и для настройки этих взаимодействий.

## Особенности использования service mesh Deckhouse Kubernetes Platform

Возможности по использованию service mesh в Deckhouse Kubernetes Platform зависят от используемой редакции платформы.

{% alert level="info" %}
Объединение нескольких кластеров в федерацию доступно в редакциях Enterprise Edition и Certified Security Edition Pro (1.67).
Объединение в мультикластер доступно в редакции Enterprise Edition.
{% endalert %}

В редакциях Community Edition, Basic Edition, Standard Edition, Standard Edition+ и Certified Security Edition Lite (1.67) «покрыть» сервис-мешом возможно только один кластер (для реализации определенных паттернов, например, Circuit Braker, Canary Deployment и т.д.).

## Принципиальные отличия схем межкластерного взаимодействия

Федерация объединяет суверенные кластеры:

- у каждого кластера собственное пространство имен (для namespace, Service и пр.);
- доступ к отдельным сервисам между кластерами явно обозначен.

Мультикластер объединяет созависимые кластеры. Пространство имен у кластеров общее — каждый сервис доступен для соседних кластеров так, словно он работает на локальном кластере (если это не запрещают правила авторизации).

## Модели объединения нескольких кластеров (на примере Istio)

При объединении нескольких кластеров с помощью Istio могут использоваться несколько моделей:

- Сетевые модели: кластеры находятся в одной сети или в разных сетях.
- Модели использования управляющего слоя: один или несколько управляющих слоев service mesh.
- Модели изоляции: изоляция тенантов на уровне пространств имен, сетей или кластеров.
- Модели использования сервис-мешей: один сервис-меш или несколько.

Сочетая эти модели, можно строить мультикластеры или федерации из нескольких кластеров, соответствующие ваши потребностям.

## Задачи, решаемые с помощью мультикластера и федерации

Объединение кластеров в федерацию или мультикластер поможет решить следующие задачи:

- Геораспределенность и ГЕО-балансировка трафика: кластеры обслуживают пользователей ближе к их локации.
- Отказоустойчивость. Если один кластер (или дата-центр) падает, трафик автоматически переключается на другие (автоматический failover).
- Горизонтальное масштабирование. Разделение сервисов по кластерам увеличивает общую пропускную способность, что позволяет избежать ситуаций, когда один кластер не справляется с нагрузкой.
- Изоляция окружений и ресурсов. При использовании мультикаластера или федерации разные окружения (например, production, staging и develop) и ресурсы для разных команд могут работать в отдельных кластерах, но при необходимости могут взаимодействовать.
- Соответствие требованиям регуляторов. Мультикаластер и федерация помогут обеспечить соответствие требованиям по хранению данных в определенных регионах.
- Создание гибридных и мульти-облачных инфраструктур.
