---
title: "Container image vulnerability scanning"
permalink: en/user/security/scanning.html
---

Deckhouse Kubernetes Platform (DKP) provides a built-in tool for automatically detecting vulnerabilities  
in container images based on the [Trivy](https://github.com/aquasecurity/trivy) project.

Below are commands for viewing and filtering reports on vulnerability scans and CIS compliance checks performed in the cluster.

## Viewing CIS compliance check results

- To list all resources that failed the compliance check:

  ```shell
  d8 k get clustercompliancereports.aquasecurity.github.io cis -ojson |
    jq '.status.detailReport.results | map(select(.checks | map(.success) | all | not))'
  ```

- To search by a specific check ID:

  ```shell
  check_id="5.7.3"
  d8 k get clustercompliancereports.aquasecurity.github.io cis -ojson |
    jq --arg check_id "$check_id" '.status.detailReport.results | map(select(.id == $check_id))'
  ```

- To search by check description:

  ```shell
  check_desc="Apply Security Context to Your Pods and Containers"
  d8 k get clustercompliancereports.aquasecurity.github.io cis -ojson |
    jq --arg check_desc "$check_desc" '.status.detailReport.results | map(select(.description == $check_desc))'
  ```
