---
title: "Grafana"
permalink: ru/user/web/grafana.html
lang: ru
---

Веб-интерфейс системы мониторинга
В качестве веб-интерфейса системы мониторинга используется Grafana.
5.3.1.1 Главный экран
На главном экране Grafana расположена основная информация о кластере и его основных компонентах.

Рисунок 2 Главный экран.

В левой верхней части экрана указаны характеристики основных компонентов кластера: версия containerd, дистрибутив Linux, на базе которого работает кластер, а также версии Grafana, Prometheus и т.д.

Рисунок 3 Левая верхняя часть главного экрана.

В правой верхней части экрана расположены удобные графические обозначения для основных параметров — количества узлов кластере, количество запущенных в ней подов и других сущностей кластера.

Рисунок 4 Правая верхняя часть главного экрана.

Для получения более подробной информации можно навести на любой элемент курсор мыши, нужная информация отображается во всплывающей подсказке:

Рисунок 6 Всплывающие подсказки.

Ниже блоков с характеристиками расположены быстрые ссылки на дашборды некоторых компонентов кластера. Например, на мониторинг узлов кластера, потребления системных ресурсов его компонентами и статистику сетевого взаимодействия.

Рисунок 7 Ссылки на дашборды
Левее расположен блок со ссылками на веб-интерфейсы кластера, доступные для пользователя, а также блок с информацией о способе обновления кластера и временных окнах, в которые это обновление должно произойти (если они настроены).

Рисунок 8 Ссылки на веб-интерфейсы и информация о способе обновления кластера

В левом верхнем углу главного экрана расположена кнопка открытия бокового меню, в котором расположены ссылки на основные элементы Grafana.

Рисунок 9 Боковое меню.

При переходе на вкладку «Dashboards» откроется список всех доступных дашбордов Deckhouse, сгруппированных по категориям.

Рисунок 10 Список доступных дашбордов.

Они имеют вложенную структуру и сгруппированы по назначению — приложения в кластере (Applications), сетевое взаимодействие (Ingress Nginx), параметры кластера (Kubernetes Cluster), основные (Main) и безопасность (Security).
5.3.1.2 Работа с дашбордами
Дашборд представляет собой экран с расположенными на нем таблицами и графиками, содержащими информацию о выбранном компоненте кластера.

Рисунок 11 Дашборд.

5.3.1.3 Фильтрация информации
В верхней части под названием и быстрой ссылкой на родительскую категорию располагается блок фильтров, позволяющий настроить отображение, исключив из выдачи несущественную информацию или сконцентрировав выбор на одном конкретном компоненте.

Рисунок 12 Блок фильтров.

Например, на приведенном выше примере с дашбордом узлов кластера можно задать в фильтре отображение только одного из трех узлов, исключив из выдачи информацию об остальных двух узлах.

Рисунок 13 Применение фильтров.

После выбора в фильтре параметров дашборд сразу же изменится, и содержимое будет заменено на соответствующее заданным параметрам фильтрации.

Рисунок 14 Отображение информации после применения фильтров.

5.3.1.4 Работа с данными
Каждый из представленных на дашборде графиков можно открыть в более подробном виде. Для этого необходимо навести курсор на правый верхний угол блока с графиком, нажать на появившуюся кнопку с тремя точками и выбрать пункт «View».

Рисунок 15 Вывод графика.

Выбранный график откроется на весь экран.

Рисунок 16 Пример графика.

Здесь можно просмотреть более подробно информацию на графике за определенный момент времени. Для этого нужно навести курсор мыши на график — он примет вид красной горизонтальной черты, а рядом с ним отобразится всплывающее окошко с временной меткой и значением графика на этот момент:

Рисунок 17 График за определенный момент времени.

Для перехода обратно на предыдущий экран достаточно нажать «Esc».
Просмотреть подробно список записей из которых строится график, можно, выбрав в меню блока (по кнопке с тремя точками в правом верхнем углу блока) пункт «Inspect» и соответствующий запросу подпункт «Data».

Рисунок 18 Настройка просмотра списка записей из которых строится график.

В правой части экрана откроется окно с подробным содержанием записей.

Рисунок 19 Содержание записей из которых строится график.

В открывшемся окне отобразятся все данные, из которых построен график. Здесь их также можно скачать в формате *.CSV и просмотреть общую статистику (например, общее количество записей). Для этого необходимо перейти на вкладку «Stats» окна со с данными.

Рисунок 20 Скачивание данных графика.
5.3.1.5 Описание дашбордов
5.3.1.5.1 Дашборд «Applications – Log Shipper»
Состояние модуля log-shipper.

Рисунок 21 Модуль log-shipper.
Здесь представлено количество агентов модуля на узлах и их нагрузка.
5.3.1.5.2 Дашборд «Applications – Loki»
Состояние модуля loki.

Рисунок 22 Модуль loki.
5.3.1.5.3 Дашборд «Applications – Loki Logs»
Логи модуля loki.

Рисунок 23 Логи модуля loki.
5.3.1.5.4 Дашборды группы Ingress Nginx
Дашборды, связанные с Ingress-контроллерами.
5.3.1.5.4.1 Дашборд «Namespace Detail»
На этом дашборде отображается детализация компонентов в пространстве имен.

Рисунок 24 Дашборд «Namespace Detail».
Детализация компонентов в пространстве имен. В фильтрах возможно выбрать конкретное пространство имен, Ingress, Service и другие параметры для отображения.

Рисунок 25 Детализация компонентов в пространстве имен.
5.3.1.5.4.2 Дашборд «Namespaces»
Данные по Ingress-контроллеру в разрезе пространств имен кластера.

Рисунок 26 Дашборд «Namespaces».
В фильтрах можно выбрать конкретное пространство имен, виртуальные хосты и тип контента.

Рисунок 27 Фильтры для дашборда «Namespaces».
5.3.1.5.4.3 Дашборд «VHost Detail»
Подробные данные по Ingress-контроллеру в разрезе виртуальных хостов.

Рисунок 28 Дашборд «VHost Detail».
5.3.1.5.4.4 Дашборд «VHost»
Сводные данные по Ingress-контроллеру в разрезе виртуальных хостов кластера.

Рисунок 29 Дашборд «VHost».
В фильтрации можно выбрать конкретный виртуальный хост.
5.3.1.5.5 Дашборды группы «Kubernetes Cluster»
Дашборды, связанные с кластером Kubernetes.
5.3.1.5.5.1 Дашборд «Aggregating Proxy Cache»
Сводная информация по потребляемым прокси-сервером ресурсам.

Рисунок 30 Дашборд «aggregating-proxy cache».
5.3.1.5.5.2 Дашборд «Cilium Metrics»
Метрики модуля cni-cilium.

Рисунок 31 Дашборд «Cilium Metrics».
5.3.1.5.5.3 Дашборд «Control Plane Status»
Состояние управляющего слоя кластера.

Рисунок 32 Дашборд «Control Plane Status».
5.3.1.5.5.4 Дашборд «Deprecated APIs»
Отображает состояния Kubernetes API, которое на текущий момент находится в состоянии прекращения поддержки. Также на нем расположены инструкции по миграции на актуальные версии и запросы к эндпоинтам этого API.

Рисунок 33 Дашборд «Deprecated APIs».
5.3.1.5.5.5 Дашборд «DNS (coredns)»
Данные о работе компонента coredns.

Рисунок 34 Дашборд «DNS (coredns)».
5.3.1.5.5.6 Дашборд «etcd3»
Состояние базы данных etcd.

Рисунок 35 Дашборд «etcd3».
5.3.1.5.5.7 Дашборд «External ping»
Статистика внешних запросов.

Рисунок 36 Дашборд «External ping».
5.3.1.5.5.8 Дашборд «Ingress Nginx Controller Detail»
Параметры Ingress Nginx контроллера.

Рисунок 37 Дашборд «Ingress Nginx Controller Detail».
5.3.1.5.5.9 Дашборд «Ingress Nginx Controllers»
Подробные данные Ingress-контроллеры кластера.

Рисунок 38 Дашборд «Ingress Nginx Controllers».
5.3.1.5.5.10 Дашборд «Node»
Данные о работе узлов.

Рисунок 39 Дашборд «Node».
В фильтрах можно выбрать целевой узел для отображения статистики.
5.3.1.5.5.11 Дашборд «Nodes»
Сводные данные о работе узлов кластера.

Рисунок 40 Дашборд «Nodes».
В фильтрах можно выбрать конкретный узел.
5.3.1.5.5.12 Дашборд «Nodes ping»
Пинг до узлов кластера.

Рисунок 41 Дашборд «Nodes ping».
5.3.1.5.5.13 Дашборд «NTP»
Состояние сервера времени.

Рисунок 42 Дашборд «NTP».
5.3.1.5.5.14 Дашборд «Prometheus Benchmark»
Статус prometheus.

Рисунок 43 Дашборд «Prometheus Benchmark».
5.3.1.5.5.15 Дашборд «Prometheus-(self)»
Сводная информация о состоянии prometheus.

Рисунок 44 Дашборд «Prometheus-(self)».
5.3.1.5.6 Дашборды группы «Main»
Дашборды с общими данными о состоянии кластера.
5.3.1.5.6.1 Дашборд «Capacity Planning»
Сводные данные о производительности кластера.

Рисунок 45 Дашборд «Capacity Planning».
5.3.1.5.6.2 Дашборд «Deckhouse»
Сводная информация о состоянии главного компонента deckhouse.

Рисунок 46 Дашборд «Deckhouse».
5.3.1.5.6.3 Дашборд «Namespace»
Данные по конкретному пространству имен кластера.

Рисунок 47 Дашборд «Namespace».
5.3.1.5.6.4 Дашборд «Namespace / Controller»
Данные по контроллерам в пространствах имен.

Рисунок 48 Дашборд «Namespace / Controller».
В фильтрах можно выбрать конкретные пространства имен и контроллеры.
5.3.1.5.6.5 Дашборд «Namespace / Controller / Pod»
Данные по подам в пространствах имен.

Рисунок 49 Дашборд «Namespace / Controller / Pod».
В фильтрах можно выбрать определенные пространства имен и поды в них.
5.3.1.5.6.6 Дашборд «Namespaces»
Сводные данные в разрезе пространств имен в кластере.

Рисунок 50 Дашборд «Namespaces».
5.3.1.5.7 Дашборды группы Security
Работа с дашбордами группы Security описана в разделе 4.5. Просмотр журналов событий безопасности, Руководства Администратора.
