---
title: "Stronghold"
permalink: ru/user/web/stronghold.html
lang: ru
---

Веб-интерфейс модуля stronghold
Интерфейс stronghold доступен по адресу stronghold.<ШАБЛОН_ИМЕН_КЛАСТЕРА>, где <ШАБЛОН_ИМЕН_КЛАСТЕРА> – строка, соответствующая шаблону DNS-имен кластера, указанному в глобальном параметре modules.publicDomainTemplate.
При первом входе потребуется ввести учетные данные пользователя. После этого откроется главный экран Stronghold.
5.3.7.1 Главный экран и работа с механизмами секретов
При переходе по адресу stronghold.<ШАБЛОН_ИМЕН_КЛАСТЕРА> открывается раздел интерфейса для работы с механизмами секретов. Он же — главный экран.

Рисунок 103 Веб-интерфейс модуля stronghold.
В левой части экрана находится окно навигации по основным разделам пользовательского интерфейса. В центре — список механизмов секретов, используемых в кластере и кнопка для добавления нового механизма секретов.
5.3.7.1.1 Просмотр информации о механизме секретов
Кликнув по названию механизма секретов, можно посмотреть информацию о нем и о добавленных в систему секретах. В окне с информацией отображаются вкладки: «Secrets» — со списком секретов (ролей, ключей и т.д., в зависимости от механизма секретов), «Configuration» — с конфигурацией механизма и кнопка для добавления секрета (роли, ключа и т.д., в зависимости от механизма секретов).
Например, для механизма «KV» («Ключ-значение») доступна следующая информация и элементы управления:
список секретов;
конфигурация механизма;
кнопка добавления секрета.

Рисунок 104 Просмотр информации о механизме секретов.
Для просмотра конфигурации механизма секретов необходимо кликнуть по вкладке «Configuration». Содержимое вкладки зависит от просматриваемого механизма секретов.

Рисунок 105 Просмотр конфигурации механизма секретов.
5.3.7.1.1.1 Просмотр информации о секрете и его версиях (на примере механизма «Ключ-значение»)
Посмотреть информацию о секрете можно, кликнув по его названию в окне информации о механизме секретов. В окне с информацией о секрете отображается две вкладки: вкладка с общей информацией о секрете и его версиях и вкладка с метаданными секрета.
На вкладке «Secret» с общей информацией о секрете отображается переключатель для просмотра сведений о секрете в формате JSON.

Рисунок 106 Просмотр информации о секрете и его версиях.

Также на вкладке «Secret» с общей информацией о секрете отображаются кнопки для работы с секретом и его версиями:
удаление;
копирование;
выбор версии (не для всех механизмов секретов);
добавление новой версии.

Рисунок 107 Вкладка «Secret».

Для просмотра метаданных секрета необходимо кликнуть по вкладке «Metadata». После этого отобразится окно для просмотра и редактирования метаданных секрета. На вкладке отображаются метаданные секрета, кнопка для их редактирования и ссылка для добавления пользовательских метаданных.

Рисунок 108 Просмотр метаданных секрета.
5.3.7.1.1.2 Добавление секрета
Добавить новый секрет можно, кликнув по кнопке для добавления секрета (роли, ключа и т.д. — название кнопки зависит от механизма секретов) в окне с информацией о механизме секретов.

Рисунок 109 Добавление секрета.

После нажатия кнопки откроется форма добавления секрета (роли, ключи и т.д. — название кнопки зависит от механизма секретов). Состав формы зависит от механизма секретов. Например, форма для добавления секрета «Cubbyhole» содержит:
переключатель для просмотра и редактирования секрета в формате JSON;
поле для указания пути к секрету («Path»);
поле для указания ключа;
поле для указания значения;
кнопку для добавления новой пары ключ-значение (если необходимо добавить несколько ключей, которые будут иметь одинаковый «Path»).

Рисунок 110 Форма добавления секрета.
5.3.7.1.2 Добавление механизма секретов
Чтобы добавить механизм секретов, необходимо нажать кнопку «Enable new engine» на главном экране. После этого откроется экран выбора типа добавляемого механизма секретов. На нем необходимо выбрать нужный механизм и нажать кнопку «Next».

Рисунок 111 Добавление механизма секретов.

После этого откроется окно с настройками добавляемого механизма секретов. Оно состоит из двух блоков: основных настроек (различаются в зависимости от добавляемого механизма секретов) и опций («Method options» — по умолчанию блок свернут, чтобы открыть его, нужно кликнуть по его названию). Внизу окна находятся кнопки «Enable Engine» — для сохранения механизма секретов после его настройки и «Back» для возврата без сохранения на экран выбора механизма секретов.

Рисунок 112 Окно с настройками добавляемого механизма секретов.
5.3.7.2 Управление доступом к данным и функциям stronghold
Управление доступом к данным и функциям stronghold осуществляется в разделе «Access». Перейти в него можно, кликнув по пункту меню «Access» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части экрана раздела находится окно навигации по подразделам, вверху которого расположена ссылка для быстрого перехода на главный экран веб-интерфейса stronghold. В центре — информация в зависимости от выбранного в данный момент подраздела (по умолчанию — «Методы аутентификации» («Authentication Methods»)).

Рисунок 113 Управление доступом к данным и функциям stronghold.
5.3.7.2.1 Работа с методами аутентификации
Подраздел для работы с методами аутентификации открывается по умолчанию при переходе в раздел «Access» с главного экрана. Для перехода в подраздел из других подразделов необходимо кликнуть по пункту «Authentication Methods» в меню слева.

Рисунок 114 Работа с методами аутентификации.

В центре экрана находится список методов аутентификации, используемых в кластере, поля для фильтрации элементов списка и кнопка для добавления нового метода.
Для методов из списка доступны следующие действия:
просмотр конфигурации;
изменение конфигурации;
удаление метода.
Выбрать нужное действие можно, кликнув по кнопке с тремя точками, которая находится в конце строки с названием метода.

Рисунок 115 Список методов аутентификации.
5.3.7.2.1.1 Просмотр информации о методе аутентификации
Информацию о методе аутентификации можно посмотреть, кликнув по его названию или выбрав пункт «View configuration» (кликнув по кнопке с тремя точками, которая находится в конце строки с названием метода). В окне с информацией о методе аутентификации отображается одна или две вкладки (количество и содержимое вкладок зависит от метода аутентификации) с информацией о методе и кнопка для его конфигурирования.
Например, для метода аутентификации «oidc_deckhouse» в окне просмотра информации о нем отображается одна вкладка «Configuration» и кнопка «Configure».

Рисунок 116 Просмотр информации о методе аутентификации.
5.3.7.2.1.2 Добавление метода аутентификации
Добавить метод аутентификации можно, нажав кнопку для добавления метода в окне для работы с методами аутентификации (п. 5.3.7.2.1).

Рисунок 117 Добавление метода аутентификации.
После этого откроется экран выбора добавляемого метода аутентификации. На нем необходимо выбрать нужный метод и нажать кнопку «Next».

Рисунок 118 Выбор добавляемого метода аутентификации.

После этого откроется окно с настройками добавляемого метода аутентификации. Оно состоит из двух блоков: поле «Path» и опции («Method options» — по умолчанию блок свернут, чтобы открыть его, нужно кликнуть по его названию). Внизу окна находятся кнопки «Enable Method» — для сохранения метода после его настройки и «Back» для возврата без сохранения на экран выбора метода аутентификации.

Рисунок 119 Настройки добавляемого метода аутентификации.
5.3.7.2.2 Работа с группами пользователей
Для перехода в подраздел необходимо кликнуть по пункту «Groups» в меню слева.

Рисунок 120 Работа с группами пользователей.

В центре экрана находится список групп пользователей, имеющихся в кластере, поля для фильтрации элементов списка и кнопка для добавления новой группы.
Для групп из списка доступны следующие действия:
просмотр детальной информации о группе;
изменение настроек группы;
удаление групп.
Выбрать нужное действие можно, кликнув по кнопке с тремя точками, которая находится в конце строки с названием группы.

Рисунок 121 Список групп пользователей.
5.3.7.2.2.1 Просмотр информации о группе пользователей
Информацию о группе пользователей можно посмотреть, кликнув по её названию или выбрав пункт «Details» (кликнув по кнопке с тремя точками, которая находится в конце строки с названием группы). В окне с информацией о группе отображаются вкладки с разными видами информации и кнопка для редактирования группы.

Рисунок 122 Просмотр информации о группе пользователей.
5.3.7.2.2.2 Добавление группы пользователей
Добавить группу пользователя можно, нажав кнопку для добавления группы («Create group») в окне для работы с группами.

Рисунок 123 Добавление группы пользователей.

После этого откроется форма для создания группы. Под формой находятся кнопки «Create» — для сохранения группы «Back» для возврата без сохранения на экран со списком групп.

Рисунок 124 Форма для создания группы пользователей.
5.3.7.2.3 Работа с сущностями и алиасами
Сущности (Entities) в Stronghold представляют собой абстракцию пользователя или приложения, объединяющие несколько методов аутентификации под одним логическим идентификатором.
Для перехода в подраздел для работы с сущностями и алиасами необходимо кликнуть по пункту «Entities» в меню слева раздела для работы с доступами (п. 5.3.7.2).
В центре экрана находится две вкладки: «Entities» (список сущностей) и «Aliases» (список алиасов), поля для фильтрации элементов списка, кнопка объединения сущностей и кнопка для добавления новой сущности.
Для сущностей из списка на вкладке «Entities» доступны следующие действия:
просмотр детальной информации о сущности;
создание алиаса.
Выбрать нужное действие можно, кликнув по кнопке с тремя точками, которая находится в конце строки с названием сущности.

Рисунок 125 Работа с сущностями и алиасами.
Для алиасов из списка на вкладке «Aliases» доступны следующие действия:
просмотр детальной информации об алиасе;
редактирование алиаса;
удаление алиаса.
Выбрать нужное действие можно, кликнув по кнопке с тремя точками, которая находится в конце строки с названием алиаса.

Рисунок 126 Вкладка «Aliases».
5.3.7.2.3.1 Просмотр информации о сущности
Информацию о сущности можно посмотреть, кликнув по её названию в списке на вкладке «Entities» окна для работы с сущностями (п. 5.3.7.2.3) или выбрав пункт «Details» (кликнув по кнопке с тремя точками, которая находится в конце строки с названием сущности). В окне с информацией о сущности отображаются вкладки с разными видами информации, кнопка добавления сущности и кнопка для редактирования сущности.

Рисунок 127 Просмотр информации о сущности.
5.3.7.2.3.2 Просмотр информации об алиасе
Информацию об алиасе можно посмотреть, кликнув по его названию в списке на вкладке «Aliases» окна для работы с сущностями (п. 5.3.7.2.3) или выбрав пункт «Details» (кликнув по кнопке с тремя точками, которая находится в конце строки с названием алиаса). В окне с информацией об алиасе отображаются вкладки с общей информацией, метадатой и кнопка для редактирования алиаса.

Рисунок 128 Просмотр информации об алиасе.
5.3.7.2.3.3 Создание сущности
Создать сущность можно, нажав кнопку для добавления («Create entity») в окне для работы с сущностями и алиасами (п. 5.3.7.2.3).

Рисунок 129  Создание сущности.

После этого откроется форма для создания сущности. Под формой находятся кнопки «Create» — для сохранения сущности и «Back» — для возврата без сохранения на экран со списком сущностей.

Рисунок 130 Форма для создания сущности.
5.3.7.2.3.4 Создание алиаса
Добавить алиас для сущности можно, нажав на кнопку с тремя точками, которая находится в конце строки с названием сущности, в окне для работы с сущностями и алиасами (п 5.3.7.2.3) и выбрав пункт «Create alias».
После этого откроется форма для создания алиаса. Под формой находятся кнопки «Create» — для сохранения сущности и «Cancel» — для отмены.

Рисунок 131 Создание алиаса.
5.3.7.2.3.5 Объединение сущностей
Объединить сущности можно, нажав кнопку «Merge entities» в окне для работы с сущностями и алиасами (п. 5.3.7.2.5). После этого откроется форма для объединения сущностей.

Рисунок 132 Объединение сущностей.
5.3.7.2.4 Управление временными правами доступа к секретам и ресурсам (Leases)
Для перехода в подраздел для управления временными правами доступа к секретам и ресурсам (Leases) необходимо кликнуть по пункту «Leases» в меню слева в разделе для работы с доступами (п. 5.3.7.2). Откроется окно для поиска информации об аренде по ее идентификатору.

Рисунок 133 Управление временными правами доступа к секретам и ресурсам (Leases).
5.3.7.3 Работа с политиками контроля доступа
Работа с политиками контроля доступа в stronghold осуществляется в разделе «Policies». Перейти в него можно, кликнув по пункту меню «Access» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части экрана раздела для работы с политиками находится окно навигации, вверху которого расположена ссылка для быстрого перехода на главный экран веб-интерфейса stronghold. В центре размещен список политик, фильтр для поиска нужной и кнопка для добавления новой политики.
Для политик из списка доступны следующие действия:
просмотр детальной информации о политике;
редактирование политики;
удаление политики.
Выбрать нужное действие можно, кликнув по кнопке с тремя точками, которая находится в конце строки с названием политики.

Рисунок 134 Работа с политиками контроля доступа.
5.3.7.3.1 Просмотр информации о политике
Информацию о политике можно посмотреть, кликнув по её названию или выбрав пункт «Details» (кликнув по кнопке с тремя точками, которая находится в конце строки с названием политики). В окне с информацией о политике отображаются сведения о ней в формате HCL, а также кнопка для загрузки данных на компьютер и кнопка для редактирования политики.

Рисунок 135. Просмотр информации о политике
5.3.7.3.2 Добавление политики
Чтобы добавить политику, необходимо нажать кнопку «Create ACL policy» на экране для работы с политиками (п. 5.3.7.3). После этого откроется форма с полями для ввода имени политики и ее описания в формате HCL.

Рисунок 136 Добавление политики.
5.3.7.4 Работа с дополнительными инструментами
Работа с дополнительными инструментами в stronghold осуществляется в разделе «Tools». Перейти в него можно, кликнув по пункту меню «Tools» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части раздела находится окно навигации по инструментам, вверху которого расположена ссылка для быстрого перехода на главный экран веб-интерфейса stronghold. В центре отображаются поля выбранного инструмента.
5.3.7.4.1 Инструмент «Wrap»
Инструмент «Wrap» предназначен для создания wrapping token (токена обертки) для безопасной передачи секретов, который временно «упаковывает» конфиденциальные данные/секреты. Этот токен может быть передан другому пользователю или приложению, которое затем сможет «развернуть» (unwrap) его и получить доступ к «упакованным» данным.
Для доступа к инструменту кликните по пункту меню «Wrap» раздела «Tools».

Рисунок 137 Инструмент «Wrap».
5.3.7.4.2 Инструмент «Lookup»
Инструмент «Lookup» используется для просмотра информации о токенах, секретах, арендах (Lease) и иных объектах в Stronghold. С его помощью можно просматривать метаданные, сроки действия, политики доступа и другую информацию, связанную с объектами.
Для доступа к инструменту кликните по пункту меню «Lookup» раздела «Tools».

Рисунок 138 Инструмент «Lookup».
5.3.7.4.3 Инструмент «Unwrap»
Инструмент «Unwrap» предназначен для распаковки wrapping token (токена обертки) и получения доступа к «упакованным» данным
Для доступа к инструменту кликните по пункту меню «Unwrap» раздела «Tools».

Рисунок 139 Инструмент «Unwrap».
5.3.7.4.4 Инструмент «Rewrap»
Инструмент «Rewrap» предназначен для переупаковки — создания нового wrapping token (токена обертки) на основе существующего. Это позволяет продлить срок действия токена или изменить его параметры без необходимости раскрывать защищаемые данные.
Для доступа к инструменту кликните по пункту меню «Rewrap» раздела «Tools».

Рисунок 140 Инструмент «Rewrap».
5.3.7.4.5 Инструмент «Random»
Инструмент «Random» предназначен для генерации криптографически безопасных случайных данных для создания уникальных идентификаторов, токенов, паролей или иных данных, для которых важна высокая степень случайности и безопасности.
Для доступа к инструменту кликните по пункту меню «Random» раздела «Tools».

Рисунок 141 Инструмент «Random».
5.3.7.4.6 Инструмент «Hash»
Инструмент «Hash» предназначен для генерации хешей для различных данных. Поддерживается несколько алгоритмов кэширования.
Для доступа к инструменту кликните по пункту меню «Hash» раздела «Tools».

Рисунок 142 Инструмент «Hash».
5.3.7.4.7 Инструмент «API Explorer»
Инструмент «API Explorer» предоставляет пользователям удобный способ взаимодействия с API stronghold через графический интерфейс.
Для доступа к инструменту кликните по пункту меню «API Explorer» раздела «Tools».

Рисунок 143 Инструмент «API Explorer».
5.3.7.5 Мониторинг состояния Raft кластера stronghold
Мониторинг состояния Raft кластера stronghold осуществляется в разделе «Raft Storage». Перейти в него можно, кликнув по пункту меню «Raft Storage» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части интерфейса находится окно навигации по разделам. В центре отображается информация о лидере и узлах кластера, а также кнопка «Snapshots» для создания резервной копии данных Raft кластера stronghold и восстановления данных из резервной копии.

Рисунок 144 Мониторинг состояния Raft кластера stronghold.
5.3.7.6 Мониторинг активности и оценка нагрузки на stronghold
Мониторинг активности и оценка нагрузки на stronghold осуществляется в разделе «Client Count». Перейти в него можно, кликнув по пункту меню «Client Count» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части интерфейса находится окно навигации по разделам. В центре размещены две вкладки. Первая — «Dashboard» с информацией о количестве уникальных клиентов за текущий месяц и кнопками выбора другого периода.

Рисунок 145 Мониторинг активности и оценка нагрузки на stronghold.

Вторая вкладка — «Configuration». Здесь можно посмотреть настройки сбора метрик и отредактировать их (для этого необходимо нажать кнопку «Edit configuration»).

Рисунок 146 Вкладка  «Configuration».
5.3.7.7 Запечатывание и распечатывание хранилища секретов
Запечатывание и распечатывание хранилища секретов осуществляется в разделе «Seal Stronghold». Перейти в него можно, кликнув по пункту меню «Seal Stronghold» на главном экране веб-интерфейса stronghold (п. 5.3.7.1). В левой части интерфейса находится окно навигации по разделам. В центре отображается кнопка для запечатывания и распечатывания хранилища секретов (в зависимости от его текущего состояния).

Рисунок 147 Запечатывание и распечатывание хранилища секретов.

Когда хранилище находится в состоянии «запечатано» (sealed), он не может обрабатывать запросы на чтение или запись секретов.
5.3.7.8 Работа со stronghold CLI
stronghold CLI — инструмент для взаимодействия со stronghold, который позволяет выполнять различные операции по управлению секретами, настройке политик, управлению пользователями и т.д. Вызвать stronghold CLI можно, находясь в любом из разделов интерфейса. Для его запуска необходимо нажать кнопку в левом верхнем углу окна.

Рисунок 148 Работа со stronghold CLI.

Закрыть stronghold CLI можно, нажав на крестик в правом верхнем углу окна инструмента.
