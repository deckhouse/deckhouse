type: object
properties:
  podSecurityStandards:
    description: "Настройки политик Pod Security Standards (PSS)."
    properties:
      defaultPolicy:
        description: |
          Определяет политику [Pod Security Standards](https://kubernetes.io/docs/concepts/security/pod-security-standards/) по умолчанию для всех **несистемных** пространств имен:
          - `Privileged` — политика без ограничений. Данная политика допускает эскалацию привилегий;
          - `Baseline` — политика с минимальными ограничениями, ограничивающая использование эскалаций привилегий;
          - `Restricted` — политика с максимальными ограничениями, соотвествущая актуальным рекомендациям по безопасному запуску приложений в кластере.

          По умолчанию:
          - `Baseline` — при первичной установке Deckhouse версии v1.55 и выше;
          - `Privileged` — при первичной установке Deckhouse версии ниже v1.55 (обновление Deckhouse в кластере на версию v1.55 и выше **не меняет** политику по умолчанию на `Baseline`).
      enforcementAction:
        description: |
          Действие, которое будет выполнено по результатам проверки ограничений:
          - Deny — запрет;
          - Dryrun — отсутствие действия. Применяется при отладке. Информацию о событии можно посмотреть в Grafana или консоли с помощью kubectl;
          - Warn — аналогично `Dryrun`, но дополнительно к информации о событии будет выведена информация о том, из-за какого ограничения (constraint) был бы запрет действия, если бы вместо `Warn` использовался `Deny`.
      policies:
        description: "Определяет дополнительные параметры политик"
        properties:
          hostPorts:
            description: "Настройки ограничения HostPort."
            properties:
              knownRanges:
                description: "Список диапазонов портов, которые будут разрешены в привязке hostPort."
  denyVulnerableImages:
    description: |
      Настройки Trivy-провайдера.

      Trivy-провайдер запрещает создание ресурсов Pod, Deployment, StatefulSet и DaemonSet с образами, содержащими уязвимости, в неймспейсах с лейблом `security.deckhouse.io/trivy-provider: ""`.
    properties:
      allowedSeverityLevels:
        description: |-
          Список допустимых уровней критичности уязвимости.
          
          Образы контейнеров, содержащие только уязвимости указанных уровней, не будут запрещены.
      storageClass:
        description: |-
          Имя StorageClass, который используется Trivy-провайдером.

          Если значение не задано, будет использоваться StorageClass, заданный в [глобальном параметре `settings.modules.storageClass`](/products/kubernetes-platform/documentation/v1/reference/api/global.html#parameters-modules-storageclass).

          Глобальный параметр `settings.modules.storageClass` применяется только при включении модуля. Изменение глобального параметра при включенном модуле не приведет к перезаказу диска.
          
          > **Важно.** Если указать значение, отличное от текущего StorageClass, используемого существующим PersistentVolumeClaim, диск будет перезаказан, и все данные удалятся.

          Если указать `false`, вместо PVC будет принудительно использоваться `emptyDir`.
      enabled:
        description: Включить Trivy-провайдер.
      registrySecrets:
        description: |
          Список дополнительных секретов для доступа к приватным registry.

          По умолчанию для загрузки образов для сканирования используется секрет `deckhouse-registry`.
