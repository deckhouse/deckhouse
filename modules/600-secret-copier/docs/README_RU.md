---
title: "Модуль secret-copier"
---
 
Этот модуль отвечает за копирование ресурсов Secret во все пространства имён.

Он полезен тем, что позволяет не копировать каждый раз в CI ресурсы Secret для пуллинга образов и заказа RBD в Ceph.

### Как работает?

Модуль `secret-copier` следит за изменениями ресурсов Secret в пространстве имён `default` с лейблом `secret-copier.deckhouse.io/enabled: ""`.
* Созданный ресурс Secret будет скопирован во все пространства имён.
* Изменённый ресурс Secret с его новым содержимым будет раскопирован во все пространства имён.
* При удалении ресурс Secret будет удален из всех пространств имён.
* При изменении скопированного ресурса Secret в прикладном пространстве имён, тот будет перезаписан оригинальным содержимым.
* При создании любого пространства имён в него копируются все ресурсы Secret из пространства имён `default` с лейблом `secret-copier.deckhouse.io/enabled: ""`.

Кроме этого, каждую ночь ресурсы Secret будут повторно синхронизированы и приведены к состоянию в пространств имён `default`.

### Что нужно настроить?

Чтобы все заработало, достаточно создать в пространстве имён `default` Secret с лейблом `secret-copier.deckhouse.io/enabled: ""`.

> **Внимание!** Рабочим пространством имён для модуля является `default`, Ресурсы Secret будут копироваться только из него. Ресурсы с лейблом `secret-copier.deckhouse.io/enabled: ""`, созданные в других пространствах имён при включенном модуле будут автоматически удалены.

### Как ограничить список пространств имён, в которые будет производиться копирование?

Для этого нужно задать label–селектор в значении аннотации `secret-copier.deckhouse.io/target-namespace-selector`. Например: `secret-copier.deckhouse.io/target-namespace-selector: "app=custom"`. Модуль создаст копию этого ресурса Secret во всех пространствах имён, соответствующих заданному label–селектору.
