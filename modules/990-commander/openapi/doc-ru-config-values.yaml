properties:
  auth:
    description: |
      Доступ к web-интерфейсу.
    properties:
      externalAuthentication:
        description: |
          Параметры для подключения внешней аутентификации (используется механизм Nginx Ingress external-auth, работающий на основе модуля Nginx auth_request.

          > Внешняя аутентификация включается автоматически, если включен модуль [user-authn](/modules/user-authn/).
        properties:
          authURL:
            description: |
              URL сервиса аутентификации. Если пользователь прошел аутентификацию, сервис должен возвращать код ответа HTTP 200.
          authSignInURL:
            description: |
              URL, куда будет перенаправлен пользователь для прохождения аутентификации (если сервис аутентификации вернул код ответа HTTP, отличный от 200).
      password:
        description: |
          **Этот параметр ни на что не влияет и в будущих релизах будет удален.**

          Раньше он использовался для HTTP-авторизации для пользователя `admin`, если не был включен модуль [user-authn](/modules/user-authn/) или не был задан параметр `externalAuthentication`.

          Теперь внешняя аутентификация обязательна для корректной работы Deckhouse Commander.
      allowedUserGroups:
        description: |
          Массив групп, пользователям которых разрешен доступ к веб-интерфейсу.

          Используется, если включен модуль [user-authn](/modules/user-authn/) или задан параметр `externalAuthentication`.

          **Внимание!** При использовании совместно с модулем [user-authn](/modules/user-authn/) необходимо также добавить разрешенные группы в соответствующее поле в настройках DexProvider.
      whitelistSourceRanges:
        description: |
          Список адресов в формате CIDR, которым разрешено проходить аутентификацию.

          Если параметр не указан, аутентификацию разрешено проходить без ограничения по IP-адресу.
  ingressClass:
    description: |
      Класс Ingress-контроллера, который используется для веб-интерфейса.

      Опциональный параметр, по умолчанию используется глобальное значение `modules.ingressClass`.
  https:
    description: |
      Тип используемого сертификата.

      При использовании этого параметра полностью переопределяются глобальные настройки `global.modules.https`.
    properties:
      mode:
        description: |
          Режим работы HTTPS:
          - `Disabled` — доступ только по HTTP. **Внимание! Данный режим не поддерживается**. HTTPS обязателен для корректной работы модуля. Если HTTPS отключен, веб-интерфейс модуля будет недоступен.
          - `CertManager` — доступ по HTTPS с заказом сертификата согласно ClusterIssuer’у, заданному в параметре `certManager.clusterIssuerName`. [Подробнее](/reference/api/global.html#parameters-modules-https-certmanager-clusterissuername).
          - `CustomCertificate` — доступ по HTTPS с использованием сертификата из пространства имен `d8-system`.
          - `OnlyInURI` — доступ по HTTP, подразумевая, что перед веб-интерфейсом стоит внешний HTTPS-балансер, который терминирует HTTPS, и все ссылки в [user-authn](/modules/user-authn/) будут генерироваться с HTTPS-схемой. Балансировщик должен обеспечивать перенаправление с HTTP на HTTPS.
      certManager:
        properties:
          clusterIssuerName:
            description: |
              Тип ClusterIssuer’а, используемого для заказа SSL-сертификата.

              В данный момент доступны `letsencrypt`, `letsencrypt-staging`, `selfsigned`, но возможно определить свои.
      customCertificate:
        properties:
          secretName:
            description: |
              Имя Secret’а в пространстве имен d8-system, который будет использоваться для веб-интерфейса.

              Secret должен быть в формате kubernetes.io/tls.
  postgres:
    properties:
      mode:
        description: |
          Режим работы PostgreSQL:
          - `External` - Используется внешняя инсталляция PostgreSQL, управляемая пользователем. Это рекомендуемый способ использования Deckhouse Commander в производственных средах.
      external:
        properties:
          host:
            description: |
              Адрес сервера, можно указать несколько адресов через запятую если у вас кластер PostgreSQL состоит из нескольких узлов. Например: `host1,host2,host3`. В таком случае вам надо будет для каждого узла указать свой порт.
          port:
            description: |
              Порт сервера, если у вас кластер PostgreSQL состоит из нескольких узлов и указаны несколько узлов то нужно указать порт для каждого узла через запятую. Например: `5432,5432,5433`
          user:
            description: Имя пользователя
          password:
            description: Пароль пользователя
          db:
          ssl:
            properties:
              secretName:
                description: |
                  Имя секрета в неймспейсе `d8-commander`, который содержит клиентский сертификат для [аутентификации по сертификату](https://www.postgresql.org/docs/14/auth-cert.html) на сервере PostgreSQL.

                  Пример создания секрета: `kubectl -n d8-commander create secret generic postgres-ssl --from-file=tls.crt=client.crt --from-file=tls.key=client.key --from-file=ca.crt=ca.crt`
  highAvailability:
    description: |
      Ручное управление режимом отказоустойчивости.

      По умолчанию режим отказоустойчивости определяется автоматически.
  nodeSelector:
    description: |
      Структура, аналогичная `spec.nodeSelector` пода Kubernetes.

      Если ничего не указано или указано `false`, будет использоваться автоматика.
  tolerations:
    description: |
      Структура, аналогичная `spec.tolerations` пода Kubernetes.

      Если ничего не указано или указано `false`, будет использоваться автоматика.
