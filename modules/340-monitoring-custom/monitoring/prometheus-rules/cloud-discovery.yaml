- name: d8.monitoring-custom.cloud-discovery
  rules:
  - alert: ClusterHasOrphanedDisks
    for: 1h
    expr: max by(job, id, name)(cloud_data_discovery_orphaned_disk_info == 1)
    labels:
      severity_level: "6"
      d8_module: monitoring-custom
      d8_component: monitoring-custom
    annotations:
      plk_protocol_version: "1"
      plk_markup_format: "markdown"
      summary: Cloud data discoverer finds disks in the cloud for which there is no PersistentVolume in the cluster
      plk_create_group_if_not_exists__main: "ClusterHasOrphanedDisks,tier=cluster,prometheus=deckhouse,kubernetes=~kubernetes"
      plk_grouped_by__main: "ClusterHasOrphanedDisks,tier=cluster,prometheus=deckhouse,kubernetes=~kubernetes"
      description: |
        Cloud data discoverer finds disks in the cloud for which there is no PersistentVolume in the cluster. You can manually delete these disks from your cloud:
          ID: {{ $labels.id }}, Name: {{ $labels.name }}
