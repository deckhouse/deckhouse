---
apiVersion: deckhouse.io/v1
kind: DexProvider
metadata:
  name: corp-ldap
spec:
  type: LDAP
  displayName: "LDAP (Kerberos SSO)"
  ldap:
    host: "openldap.d8-user-authn.svc:389"
    insecureNoSSL: true

    bindDN: "cn=admin,dc=example,dc=com"
    bindPW: "admin"

    userSearch:
      baseDN: "dc=example,dc=com"
      filter: "(objectClass=inetOrgPerson)"
      username: "cn"
      idAttr: "cn"
      emailAttr: "mail"
      nameAttr: "cn"

    groupSearch:
      baseDN: "dc=example,dc=com"
      filter: "(objectClass=groupOfNames)"
      userMatchers:
        - userAttr: "DN"
          groupAttr: "member"
      nameAttr: "cn"

    kerberos:
      enabled: true
      keytabSecretName: dex-kerberos-test
      usernameFromPrincipal: Localpart
      fallbackToPassword: false


