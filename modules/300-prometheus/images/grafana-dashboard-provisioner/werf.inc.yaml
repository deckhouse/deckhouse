image: {{ .ModuleName }}/{{ .ImageName }}
from: {{ .Images.BASE_SHELL_OPERATOR }}
shell:
  beforeInstall:
  - apk add --no-cache python3 py3-pip
  beforeSetup:
  - pip3 install -r /tmp/requirements.txt
  - apk del py3-pip
  - rm -rf /var/cache/apk/*
  - rm -f /tmp/requirements.txt
git:
- add: /{{ $.ModulePath }}modules/300-{{ $.ModuleName }}/images/{{ $.ImageName }}/requirements.txt
  to: /tmp/requirements.txt
  stageDependencies:
    beforeSetup:
      - '**/*'
- add: /{{ $.ModulePath }}modules/300-{{ $.ModuleName }}/images/{{ $.ImageName }}/hooks
  to: /hooks
  stageDependencies:
    beforeSetup:
    install:
      - '**/*'
