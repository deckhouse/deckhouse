image: {{ .ModuleName }}/{{ .ImageName }}
fromImage: common/shell-operator
import:
- image: {{ $.ModuleName }}/{{ $.ImageName }}-binaries-artifact
  add: /
  to: /
  before: setup
  includePaths:
  - usr/bin/python3
  - usr/bin/python3.*
  - usr/lib/python3
  - usr/lib64/python3
  - usr/lib64/python3.*
git:
- add: /{{ $.ModulePath }}modules/300-{{ $.ModuleName }}/images/{{ $.ImageName }}/hooks
  to: /hooks
  stageDependencies:
    install:
    - '**/*'

---
image: {{ $.ModuleName }}/{{ $.ImageName }}-binaries-artifact
final: false
from: {{ $.Images.BASE_ALT_P11 }}
import:
- image: common/shell-operator-artifact
  add: /
  to: /
  before: setup
  includePaths:
  - usr/bin/python3
  - usr/bin/python3.*
  - usr/lib/python3
  - usr/lib64/python3
  - usr/lib64/python3.*
git:
- add: /{{ $.ModulePath }}modules/300-{{ $.ModuleName }}/images/{{ $.ImageName }}/requirements.txt
  to: /requirements.txt
  stageDependencies:
    install:
    - '**/*'
shell:
  beforeInstall:
  - apt-get update
  - apt-get install -y python3-module-pip-run
  install:
  - pip3 install -r /requirements.txt
