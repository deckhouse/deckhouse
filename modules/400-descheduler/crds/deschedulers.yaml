---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.10.0
  creationTimestamp: null
  name: deschedulers.deckhouse.io
spec:
  group: deckhouse.io
  names:
    kind: Descheduler
    listKind: DeschedulerList
    plural: deschedulers
    singular: descheduler
  scope: Cluster
  versions:
    - additionalPrinterColumns:
        - jsonPath: .status.ready
          name: Ready
          type: boolean
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: Descheduler is a description of a single descheduler instance
          properties:
            spec:
              description: Spec defines the behavior of a descheduler instance.
              properties:
                deploymentTemplate:
                  description: Defines Template of a descedhuler Deployment
                  properties:
                    nodeSelector:
                      additionalProperties:
                        type: string
                      type: object
                    tolerations:
                      items:
                        properties:
                          effect:
                            type: string
                          key:
                            type: string
                          operator:
                            type: string
                          tolerationSeconds:
                            format: int64
                            type: integer
                          value:
                            type: string
                        type: object
                      type: array
                  type: object
                deschedulerPolicy:
                  description: commonParameters and strategies follow descheduler's documentation https://github.com/kubernetes-sigs/descheduler#policy-and-strategies
                  properties:
                    parameters:
                      description: Parameters that apply to all policies
                      properties:
                        evictFailedBarePods:
                          description: EvictFailedBarePods allows pods without ownerReferences and in failed phase to be evicted.
                          type: boolean
                        evictLocalStoragePods:
                          description: EvictLocalStoragePods allows pods using local storage to be evicted.
                          type: boolean
                        evictSystemCriticalPods:
                          description: 'EvictSystemCriticalPods allows eviction of pods of any priority (including Kubernetes system pods) Note: Setting evictSystemCriticalPods to true disables priority filtering entirely.'
                          type: boolean
                        ignorePvcPods:
                          description: IgnorePVCPods prevents pods with PVCs from being evicted.
                          type: boolean
                        maxNoOfPodsToEvictPerNamespace:
                          description: MaxNoOfPodsToEvictPerNamespace restricts maximum of pods to be evicted per namespace.
                          type: integer
                        maxNoOfPodsToEvictPerNode:
                          description: MaxNoOfPodsToEvictPerNode restricts maximum of pods to be evicted per node.
                          type: integer
                        nodeSelector:
                          type: string
                      type: object
                    strategies:
                      default:
                        removePodsViolatingInterPodAntiAffinity: {}
                        removePodsViolatingNodeAffinity: {}
                      description: 'List of strategies with corresponding parameters for a given Descheduler instances To enable a strategy with default parameters, specify it like this: removePodsViolatingNodeAffinity: {}'
                      properties:
                        highNodeUtilization:
                          properties:
                            params:
                              default:
                                nodeResourceUtilizationThresholds:
                                  thresholds:
                                    cpu: 50
                                    memory: 50
                              properties:
                                nodeFit:
                                  type: boolean
                                nodeResourceUtilizationThresholds:
                                  properties:
                                    numberOfNodes:
                                      type: integer
                                    targetThresholds:
                                      additionalProperties:
                                        type: number
                                      type: object
                                    thresholds:
                                      additionalProperties:
                                        type: number
                                      type: object
                                    useDeviationThresholds:
                                      type: boolean
                                  type: object
                              type: object
                          type: object
                        lowNodeUtilization:
                          properties:
                            params:
                              default:
                                nodeResourceUtilizationThresholds:
                                  targetThresholds:
                                    cpu: 50
                                    memory: 50
                                    pods: 50
                                  thresholds:
                                    cpu: 20
                                    memory: 20
                                    pods: 20
                              properties:
                                nodeFit:
                                  type: boolean
                                nodeResourceUtilizationThresholds:
                                  properties:
                                    numberOfNodes:
                                      type: integer
                                    targetThresholds:
                                      additionalProperties:
                                        type: number
                                      type: object
                                    thresholds:
                                      additionalProperties:
                                        type: number
                                      type: object
                                    useDeviationThresholds:
                                      type: boolean
                                  type: object
                              type: object
                          type: object
                        podLifeTime:
                          properties:
                            params:
                              default:
                                podLifeTime:
                                  maxPodLifeTimeSeconds: 86400
                                  podStatusPhases:
                                    - Pending
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                podLifeTime:
                                  properties:
                                    maxPodLifeTimeSeconds:
                                      type: integer
                                    podStatusPhases:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removeDuplicates:
                          properties:
                            params:
                              properties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                removeDuplicates:
                                  properties:
                                    excludeOwnerKinds:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removeFailedPods:
                          properties:
                            params:
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                removeFailedPods:
                                  properties:
                                    excludeOwnerKinds:
                                      items:
                                        type: string
                                      type: array
                                    includingInitContainers:
                                      type: boolean
                                    minPodLifetimeSeconds:
                                      type: integer
                                    reasons:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removePodsHavingTooManyRestarts:
                          properties:
                            params:
                              default:
                                podsHavingTooManyRestarts:
                                  includingInitContainers: true
                                  podRestartThreshold: 100
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                podsHavingTooManyRestarts:
                                  properties:
                                    includingInitContainers:
                                      type: boolean
                                    podRestartThreshold:
                                      format: int32
                                      type: integer
                                  type: object
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removePodsViolatingInterPodAntiAffinity:
                          properties:
                            params:
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removePodsViolatingNodeAffinity:
                          properties:
                            params:
                              default:
                                nodeAffinityType:
                                  - requiredDuringSchedulingIgnoredDuringExecution
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeAffinityType:
                                  items:
                                    type: string
                                  type: array
                                nodeFit:
                                  type: boolean
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removePodsViolatingNodeTaints:
                          properties:
                            params:
                              properties:
                                excludedTaints:
                                  items:
                                    type: string
                                  type: array
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                        removePodsViolatingTopologySpreadConstraint:
                          properties:
                            params:
                              properties:
                                includeSoftConstraints:
                                  type: boolean
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                            type: string
                                          operator:
                                            type: string
                                          values:
                                            items:
                                              type: string
                                            type: array
                                        required:
                                          - key
                                          - operator
                                        type: object
                                      type: array
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                        type: string
                                      type: array
                                    include:
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                nodeFit:
                                  type: boolean
                                thresholdPriority:
                                  format: int32
                                  type: integer
                                thresholdPriorityClassName:
                                  type: string
                              type: object
                          type: object
                      type: object
                  type: object
              type: object
            status:
              description: Most recently observed status of a descheduler instance.
              properties:
                ready:
                  type: boolean
              required:
                - ready
              type: object
          required:
            - spec
          type: object
      served: true
      storage: true
      subresources:
        status: {}
