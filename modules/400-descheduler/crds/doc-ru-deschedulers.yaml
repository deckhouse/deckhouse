spec:
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: Описывает параметры инстанса descheduler.
          properties:
            spec:
              description: Параметры инстанса descheduler.
              properties:
                deploymentTemplate:
                  description: Шаблон Deployment'а descheduler.
                deschedulerPolicy:
                  description: '`parameters` и `strategies` полностью соответствуют [документации]( https://github.com/kubernetes-sigs/descheduler#policy-and-strategies).'
                  properties:
                    parameters:
                      description: Параметры, применяющиеся ко всем политикам.
                      properties:
                        evictFailedBarePods:
                          description: Позволяет Pod'ам без установленного `ownerReferences` и в фазе failed быть вытесненными.
                        evictLocalStoragePods:
                          description: Позволяет Pod'ам с local storage быть вытесненными.
                        evictSystemCriticalPods:
                          description: |
                            Разрешает вытеснять Pod'ы с любым приоритетом (включая системные Pod'ы Kubernetes).

                            > **Внимание!** Включение опции полностью отключит priority filtering политики.
                        ignorePvcPods:
                          description: Отключает вытеснение Pod'ов с PVC.
                        maxNoOfPodsToEvictPerNamespace:
                          description: Ограничивает количество Pod'ов в отдельном Namespace, которые можно вытеснять одновременно.
                        maxNoOfPodsToEvictPerNode:
                          description: Ограничивает количество Pod'ов на отдельном узле, которые можно вытеснять одновременно.
                        nodeSelector:
                          description: NodeSelector для узлов, на Pod'ы которых буду действовать стратегии этого descheduler.
                    strategies:
                      description: |
                        Список [стратегий](./#стратегий) и их параметров инстанса этого Descheduler.

                        Чтобы применить стратегию, но не передавать ей каких-либо параметров, просто укажите её так:
                        `removePodsViolatingNodeAffinity: {}`.
                      properties:
                        highNodeUtilization:
                          properties:
                            params:
                              default:
                                nodeResourceUtilizationThresholds:
                                  thresholds:
                                    cpu: 50
                                    memory: 50
                              properties:
                                nodeFit:
                                nodeResourceUtilizationThresholds:
                                  properties:
                                    numberOfNodes:
                                    targetThresholds:
                                      additionalProperties:
                                    thresholds:
                                      additionalProperties:
                                    useDeviationThresholds:
                        lowNodeUtilization:
                          properties:
                            params:
                              default:
                                nodeResourceUtilizationThresholds:
                                  targetThresholds:
                                    cpu: 50
                                    memory: 50
                                    pods: 50
                                  thresholds:
                                    cpu: 20
                                    memory: 20
                                    pods: 20
                              properties:
                                nodeFit:
                                nodeResourceUtilizationThresholds:
                                  properties:
                                    numberOfNodes:
                                    targetThresholds:
                                      additionalProperties:
                                    thresholds:
                                      additionalProperties:
                                    useDeviationThresholds:
                        podLifeTime:
                          properties:
                            params:
                              default:
                                podLifeTime:
                                  maxPodLifeTimeSeconds: 86400
                                  podStatusPhases:
                                    - Pending
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                podLifeTime:
                                  properties:
                                    maxPodLifeTimeSeconds:
                                    podStatusPhases:
                                      items:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removeDuplicates:
                          properties:
                            params:
                              properties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                removeDuplicates:
                                  properties:
                                    excludeOwnerKinds:
                                      items:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removeFailedPods:
                          properties:
                            params:
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                removeFailedPods:
                                  properties:
                                    excludeOwnerKinds:
                                      items:
                                    includingInitContainers:
                                    minPodLifetimeSeconds:
                                    reasons:
                                      items:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removePodsHavingTooManyRestarts:
                          properties:
                            params:
                              default:
                                podsHavingTooManyRestarts:
                                  includingInitContainers: true
                                  podRestartThreshold: 100
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                podsHavingTooManyRestarts:
                                  properties:
                                    includingInitContainers:
                                    podRestartThreshold:
                                      format: int32
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removePodsViolatingInterPodAntiAffinity:
                          properties:
                            params:
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removePodsViolatingNodeAffinity:
                          properties:
                            params:
                              default:
                                  - requiredDuringSchedulingIgnoredDuringExecution
                              properties:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                  items:
                                nodeFit:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removePodsViolatingNodeTaints:
                          properties:
                            params:
                              properties:
                                excludedTaints:
                                  items:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
                        removePodsViolatingTopologySpreadConstraint:
                          properties:
                            params:
                              properties:
                                includeSoftConstraints:
                                labelSelector:
                                  properties:
                                    matchExpressions:
                                      items:
                                        properties:
                                          key:
                                          operator:
                                          values:
                                            items:
                                        required:
                                          - key
                                          - operator
                                    matchLabels:
                                      additionalProperties:
                                namespaces:
                                  properties:
                                    exclude:
                                      items:
                                    include:
                                      items:
                                nodeFit:
                                thresholdPriority:
                                  format: int32
                                thresholdPriorityClassName:
            status:
              description: Most recently observed status of a descheduler instance.
              properties:
                ready:
              required:
                - ready
          required:
            - spec
