artifact: {{ $.ModuleName }}/nvme-cli-static-builder-artifact
from: {{ $.Images.BASE_UBUNTU }}
shell:
  beforeInstall:
  - apt update
  - | 
    apt install --no-install-recommends -y \
      wget git bzip2 curl tar ca-certificates \
      gcc make meson ninja-build automake autopoint gettext pkg-config \
      libnvme-dev libnvme1 libjson-c-dev libkeyutils1 \
      libkeyutils-dev libhugetlbfs-dev swig libdbus-1-3 \
      libssl-dev openssl
  install:
    - mkdir /build
    - cd /build
    - git clone -n https://github.com/linux-nvme/nvme-cli.git .
    - git checkout d812d09
    - make static
---
image: {{ $.ModuleName }}/{{ $.ImageName }}
fromImage: common/distroless
import:
- artifact: {{ $.ModuleName }}/nvme-cli-static-builder-artifact
  add: /build/.build/nvme
  to: /build/nvme
  before: setup