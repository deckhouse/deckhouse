{{- with .Values.registry.internal.orchestrator -}}
---
apiVersion: v1
kind: Secret
metadata:
  name: registry-state
  namespace: d8-system
  {{- include "helm_lib_module_labels" (list $ (dict "app" "registry" "type" "registry-state" )) | nindent 2 }}
  annotations:
    registry.deckhouse.io/config-hash: {{ .hash | quote }}
type: registry/state
data:
  hash: {{ .hash | b64enc }}
  state: {{ .state | toYaml | b64enc }}
  conditions: {{ .state.conditions | toYaml | b64enc }}
  mode: {{ .state.mode | b64enc }}
  target_mode: {{ .state.target_mode | b64enc }}
{{- end }}
