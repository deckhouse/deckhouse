spec:
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          type: object
          description: |
            Определяет режим и настройки обновления модуля.
          properties:
            spec:
              type: object
              properties:
                releaseChannel:
                  type: string
                  description: |
                    Желаемый канал обновления модуля.
                    Порядок возрастания стабильности канала обновлений (от **наименее** стабильного к **наиболее** стабильному): `Alpha`, `Beta`, `EarlyAccess`, `Stable`, `RockSolid`.
                update:
                  type: object
                  description: |
                    Режим и настройки обновления модуля.
                  properties:
                    mode:
                      type: string
                      description: |
                        Режим обновления минорных версий модуля.
                        - `Auto` (автоматический) — все обновления применяются автоматически.

                          Обновления минорной версии модуля (обновление релиза, например, с `v1.26.*` на `v1.27.*`) применяются с учетом заданных окон обновлений либо, если окна обновлений не заданы, по мере появления обновлений на соответствующем канале обновлений.
                        - `Manual` (ручной) — для обновления минорной версии модуля в ручном режиме (обновление релиза, например, с `v1.26.*` на `v1.27.*`) необходимо подтверждение.

                          Для подтверждения обновления в соответствующем ресурсе modulereleases.deckhouse.io необходимо установить поле `approved` в `true`.
                    windows:
                      type: array
                      description: |
                        Расписание окон обновления модуля.
                      items:
                        type: object
                        properties:
                          from:
                            type: string
                            description: |
                              Время начала окна обновления (в часовом поясе UTC).

                              Должно быть меньше времени окончания окна обновления.
                          to:
                            type: string
                            description: |
                              Время окончания окна обновления (в часовом поясе UTC).

                              Должно быть больше времени начала окна обновления.
                          days:
                            type: array
                            description: Дни недели, в которые применяется окно обновлений.
                            items:
                              type: string
                              description: День недели.
                moduleReleaseSelector:
                  type: object
                  description: |
                    Определяет модули к которым применяются вышеуказанные настройки обновления.
                    properties:
                      labelSelector:
                        description: |
                          Определяет фильтр на основе меток, указанных у целевых модулей.

                          Если указаны одновременно `matchExpressions` и `matchLabels`, учитываются оба фильтра (AND).
                        type: object
                        properties:
                          matchExpressions:
                            type: array
                            description: Список фильтров на основе выражений.
                            items:
                              type: object
                              properties:
                                key:
                                  description: Имя метки.
                                  type: string
                                operator:
                                  description: Оператор сравнения.
                                  type: string
                                values:
                                  type: array
                                  description: Значение метки.
                                  items:
                                    type: string
                          matchLabels:
                            type: object
                            description: Фильтр на основе совпадения меток.
                            additionalProperties:
                              type: string
            status:
              type: object
              properties:
                matchedModules:
                  type: string
                  description: Список модулей подпадающих под данные настройки обновления.
                errors:
                  type: string
                  items:
                    type: string
                  description: Список сообщений об ошибках.
      subresources:
        status: {}
      additionalPrinterColumns:
        - name: modules
          jsonPath: .status.matchedModules
          type: string
          description: Список модулей подпадающих под данные настройки обновления.
        - name: release channel
          jsonPath: .spec.releaseChannel
          type: string
          description: Канал обновления модуля.
        - name: errors
          jsonPath: .status.errors
          type: string
          description: Список сообщений об ошибках.
