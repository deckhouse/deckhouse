{{- if .Values.cloudProviderYandex.cloudMetricsExporterEnabled }}
apiVersion: v1
kind: Secret
metadata:
  name: cloud-metrics-exporter-app-creds
  namespace: d8-cloud-provider-yandex
  {{- include "helm_lib_module_labels" (list . (dict "app" "cloud-metrics-exporter")) | nindent 2 }}
  annotations:
    {{- if .Values.cloudProviderYandex.internal.exporter.serviceAccountChecksum }}
    checksum/service-account: {{ .Values.cloudProviderYandex.internal.exporter.serviceAccountChecksum | quote }}
    {{- end }}
    {{- if .Values.cloudProviderYandex.internal.exporter.apiKeyID }}
    service-account-api-key/id: {{ .Values.cloudProviderYandex.internal.exporter.apiKeyID | quote }}
    {{- end }}
type: Opaque
data:
  api-key: {{ .Values.cloudProviderYandex.internal.exporter.apiKey | b64enc | quote }}
  folder-id: {{ .Values.cloudProviderYandex.internal.providerClusterConfiguration.provider.folderID | b64enc | quote }}
{{- end }}
