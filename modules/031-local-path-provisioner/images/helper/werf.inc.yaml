---
artifact: {{ $.ModuleName }}/{{ $.ImageName }}-artifact-dir-manager
from: {{ $.Images.BASE_GOLANG_19_ALPINE }}
git:
  - add: /{{ $.ModulePath }}modules/031-{{ $.ModuleName }}/images/{{ $.ImageName }}/dir-manager
    to: /src
    stageDependencies:
      install:
        - '**/*'
shell:
  install:
    - export "CGO_ENABLED=0"
    - export "GOOS=linux"
    - export "GOARCH=amd64"
    - cd /src
    - go build -o /tmp/manager main.go
    - chmod 0777 /tmp/manager
---
image: {{ $.ModuleName }}/{{ $.ImageName }}
fromImage: common/distroless
import:
 - artifact: {{ $.ModuleName }}/{{ $.ImageName }}-artifact-dir-manager
   add: /tmp/manager
   to: /manager
   before: setup
