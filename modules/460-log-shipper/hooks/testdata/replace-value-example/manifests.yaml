---
apiVersion: deckhouse.io/v1alpha1
kind: ClusterLoggingConfig
metadata:
  name: test-source
spec:
  type: File
  file:
    include: ["/var/log/app/application.log"]
  destinationRefs:
    - test-loki-dest
---
apiVersion: deckhouse.io/v1alpha1
kind: ClusterLogDestination
metadata:
  name: test-loki-dest
spec:
  type: Loki
  loki:
    endpoint: http://loki.loki:3100
  transformations:
  - action: ReplaceValue
    replaceValue:
      label: .message
      patterns:
        - source: 'password=\w+'
          target: 'password=***'
        - source: 'token:\s*[\w\-]+'
          target: 'token: ***'
        - source: 'api_key=[\w\-]+'
          target: 'api_key=***' 