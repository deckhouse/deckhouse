---
title: "Модуль log-shipper"
---

Модуль для настройки log-pipeline на узлах с управлением через [Custom Resources](cr.html).

Log-pipeline позволяет доставлять логи из Pod'ов в Loki/Elasticsearch/Logstash.

### Log filters

Существуют два фильтра, чтобы снизить количество отправляемых сообщений в хранилище - `log filter` и `label filter`.

![log-shipper pipeline](../../images/460-log-shipper/log_shipper_pipeline.png)

Они запускаются сразу после объединения строк при помощи multiline parser.

1. `label filter` — правила запускаются для метаданных сообщения. Поля для метаданных (или для лейблов) наполняются на основании источника логов, так что для разных источников будет разный набор полей. Эти правила полезны, например, чтобы отбросить сообщения от определенного контейнера или от Pod'а с/без какой-то метки.
2. `log filter` — правила запускаются для исходного сообщения. Есть возможность отбросить сообщение на основании JSON поля, или, если сообщение не в формате JSON, использовать регулярное выражение для поиска по строке.

Оба фильтра имеют одинаковую структурированную конфигурацию:
* `field` — источник данных для запуска фильтрации (чаще всего это значение label'а или поля из JSON документа).
* `operator` — действие для сравнения, доступные варианты In, NotIn, Regex, NotRegex, Exists, DoesNotExist.
* `values` — это опция имеет разные значения для разных операторов.
  * DoesNotExist, Exists — не поддерживается;
  * In, NotIn — значение поле должно равняться или не равняться одному из значений в списке values;
  * Regex, NotRegex — значение должно подходить хотя бы под одно или не подходить ни под одно регулярное выражение из списка values.

Вы можете найти больше примеров в разделе [Примеры](usage.html) документации.

> NOTE: Extra labels добавляются на этапе `Destination`, поэтому невозможно фильтровать логи на их основании.
